{"version":3,"sources":["options.js"],"names":["errorDuplicateMarker","browser","i18n","getMessage","errorLabelEmpty","errorUrlEmpty","noticeSuccessExport","noticeSuccessImport","errorNoRibbonsToExport","errorChooseFile","inputChooseFile","buttonExport","buttonImport","exportFile","onError","error","console","log","showMessage","textMsg","errorFlag","messageClass","$","length","remove","append","saveSettings","urlIn","colorIn","labelIn","positionIn","settingUrl","settingColor","settingLabel","settingPosition","storage","local","get","then","result","Object","keys","storeSetting","set","[object Object]","makeJsonExportFile","text","data","Blob","type","window","URL","revokeObjectURL","createObjectURL","exportConfig","results","settingsUrls","configurations","push","url","color","label","position","configurations_json","JSON","stringify","link","document","createElement","setAttribute","href","body","appendChild","requestAnimationFrame","event","MouseEvent","dispatchEvent","removeChild","importConfig","importFileInput","getElementById","importFile","files","reader","FileReader","addEventListener","import_config_obj","parse","forEach","arrayItem","html","value","readAsText","ready","click","change","target","name"],"mappings":"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","file":"options.min.js","sourcesContent":["let errorDuplicateMarker = browser.i18n.getMessage(\"errorDuplicateMarker\");\r\nlet errorLabelEmpty = browser.i18n.getMessage(\"errorLabelEmpty\");\r\nlet errorUrlEmpty = browser.i18n.getMessage(\"errorUrlEmpty\");\r\nlet noticeSuccessExport = browser.i18n.getMessage(\"noticeSuccessExport\");\r\nlet noticeSuccessImport = browser.i18n.getMessage(\"noticeSuccessImport\");\r\nlet errorNoRibbonsToExport = browser.i18n.getMessage(\"errorNoRibbonsToExport\");\r\nlet errorChooseFile = browser.i18n.getMessage(\"errorChooseFile\");\r\nlet inputChooseFile = browser.i18n.getMessage(\"inputChooseFile\");\r\nlet buttonExport = browser.i18n.getMessage(\"buttonExport\");\r\nlet buttonImport = browser.i18n.getMessage(\"buttonImport\");\r\nlet exportFile = null;\r\n\r\nfunction onError(error) {\r\n    console.log(error);\r\n}\r\n\r\n/* Show error message */\r\nfunction showMessage(textMsg, errorFlag = false) {\r\n    let messageClass = errorFlag ? 'alert-danger' : 'alert-success';\r\n    if ($('.outer-wrapper .message-container .alert').length) {\r\n        $('.outer-wrapper .message-container .alert').remove();\r\n        $('.outer-wrapper .message-container').append('<div class=\"alert ' + messageClass + ' col-12\">' + textMsg + '</div>');\r\n    } else {\r\n        $('.outer-wrapper .message-container').append('<div class=\"alert ' + messageClass + ' col-12\">' + textMsg + '</div>');\r\n    }\r\n}\r\n\r\n/* Add a setting to storage */\r\nfunction saveSettings(urlIn, colorIn, labelIn, positionIn) {\r\n    let settingUrl = urlIn,\r\n        settingColor = colorIn,\r\n        settingLabel = labelIn,\r\n        settingPosition =  positionIn;\r\n\r\n    if (settingUrl !== '' && settingColor !== '' && settingLabel !== '') {\r\n        browser.storage.local.get(settingUrl).then((result) => {\r\n            let objTest = Object.keys(result);\r\n\r\n            if (objTest.length < 1) {\r\n                storeSetting(settingUrl, settingColor, settingLabel, settingPosition);\r\n            } else {\r\n                // Duplicate marker error message\r\n                showMessage(errorDuplicateMarker, true);\r\n            }\r\n        }, onError);\r\n    } else {\r\n        // Empty input error message\r\n        settingLabel === '' ? showMessage(errorLabelEmpty, true) : showMessage(errorUrlEmpty, true);\r\n    }\r\n}\r\n\r\n/* Store a new setting in local storage */\r\nfunction storeSetting(settingUrl, settingColor, settingLabel, settingPosition) {\r\n    browser.storage.local.set({ [settingUrl] : [settingColor, settingLabel, settingPosition] }).then(() => {\r\n        // Success\r\n    }, onError);\r\n}\r\n\r\n/* Make a URL Object from json text */\r\nfunction makeJsonExportFile(text) {\r\n    let data = new Blob([text], { type: 'application/json' });\r\n\r\n    // If we are replacing a previously generated file we need to\r\n    // manually revoke the object URL to avoid memory leaks.\r\n    if (exportFile !== null) {\r\n        window.URL.revokeObjectURL(exportFile);\r\n    }\r\n\r\n    exportFile = window.URL.createObjectURL(data);\r\n    return exportFile;\r\n}\r\n\r\n/* Get all configurations from the storage and output a json file */\r\nfunction exportConfig() {\r\n    browser.storage.local.get(null).then((results) => {\r\n        let settingsUrls = Object.keys(results),\r\n            configurations = [];\r\n\r\n        if (settingsUrls.length > 0) {\r\n            for (let settingUrl of settingsUrls) {\r\n                configurations.push({\r\n                    \"url\" : settingUrl,\r\n                    \"color\" : results[settingUrl][0],\r\n                    \"label\" : results[settingUrl][1],\r\n                    \"position\" : results[settingUrl][2]\r\n                });\r\n            }\r\n\r\n            let configurations_json = JSON.stringify(configurations);\r\n            let link = document.createElement('a');\r\n            link.setAttribute('download', 'ribbons.json');\r\n            link.href = makeJsonExportFile(configurations_json);\r\n            document.body.appendChild(link);\r\n\r\n            // wait for the link to be added to the document\r\n            window.requestAnimationFrame(function () {\r\n                let event = new MouseEvent('click');\r\n                link.dispatchEvent(event);\r\n                document.body.removeChild(link);\r\n\r\n                showMessage(noticeSuccessExport);\r\n            });\r\n        } else {\r\n            showMessage(errorNoRibbonsToExport, true);\r\n        }\r\n    }, onError);\r\n}\r\n\r\n/* Read import file and load all settings into the stoage */\r\nfunction importConfig() {\r\n    let importFileInput = document.getElementById(\"importFile\"),\r\n        importFile = importFileInput.files[0];\r\n\r\n    if (importFile) {\r\n        const reader = new FileReader();\r\n\r\n        // This event listener will happen when the reader has read the file\r\n        reader.addEventListener('load', function() {\r\n            let import_config_obj = JSON.parse(reader.result); // Parse the result into an object\r\n\r\n            if (import_config_obj.length > 0) {\r\n                import_config_obj.forEach(function(arrayItem) {\r\n                    saveSettings(arrayItem.url, arrayItem.color, arrayItem.label, arrayItem.position)\r\n                });\r\n\r\n                showMessage(noticeSuccessImport);\r\n            }\r\n\r\n            $('.import-file-label').html(inputChooseFile);\r\n            importFileInput.value = '';\r\n        });\r\n\r\n        reader.readAsText(importFile); // Read the uploaded file\r\n    } else {\r\n        showMessage(errorChooseFile);\r\n    }\r\n}\r\n\r\n$(document).ready(() => {\r\n    $('.export').click(() => {\r\n        exportConfig();\r\n    });\r\n\r\n    $('.import').click(() => {\r\n        importConfig();\r\n    });\r\n\r\n    $('#importFile').change((event) => {\r\n        if (event.target.files.length) {\r\n            $('.import-file-label').html(event.target.files[0].name);\r\n        }\r\n    });\r\n\r\n    $('button.export').html('<i class=\"fas fa-download fa-lg\"></i> ' + buttonExport);\r\n    $('button.import').html('<i class=\"fas fa-upload fa-lg\"></i> ' + buttonImport);\r\n    $('.import-file-label').html(inputChooseFile);\r\n});\r\n"]}