{"version":3,"sources":["environment-marker.js"],"names":["inputUrlFragmentPlaceholder","browser","i18n","getMessage","inputColorPlaceholder","inputLabelPlaceholder","positionSelectTopLeft","positionSelectTopRight","positionSelectBottomLeft","positionSelectBottomRight","sizeSelectExtraSmall","sizeSelectSmall","sizeSelectNormal","sizeSelectLarge","sizeSelectExtraLarge","noticeNoRibbons","buttonClearAll","buttonImportExport","errorDuplicateMarker","errorLabelEmpty","errorUrlEmpty","colorPickerUiDialog","colorPickerBtnToggle","colorPickerBtnSwatch","colorPickerBtnLastColor","colorPickerBtnSave","colorPickerBtnCancel","colorPickerBtnClear","colorPickerAriaBtnSave","colorPickerAriaBtnCancel","colorPickerAriaBtnClear","colorPickerAriaInput","colorPickerAriaPalette","colorPickerAriaHue","colorPickerAriaOpacity","pickr","hide","show","positionsMap","value","label","sizesMap","onError","error","console","log","truncateString","str","num","length","slice","initialize","storage","local","get","then","results","settingsUrls","Object","keys","showOrHideEmptyNotice","settingUrl","displaySetting","action","$","css","showMessage","textMsg","errorFlag","messageClass","remove","append","saveSettings","val","settingColor","getSelectedColor","toHEXA","toString","settingLabel","settingPosition","settingSize","result","storeSetting","set","[object Object]","settingPositionDisplay","reduce","accumulator","currentValue","settingSizeDisplay","innerSettingsContainer","class","displayContainer","displayLabelUrl","text","click","editContainer","displayColor","html","deleteBtnContainer","deleteBtn","this","parent","style","editUrlInputContainer","editUrlInput","editColorInputContainer","editColorInput","editLabelInputContainer","editLabelInput","optionsSelectPositionContainer","optionsSelectPosition","i","Option","optionsSelectSizeContainer","optionsSelectSize","undefined","updateBtnContainer","updateBtn","urlEditVal","colorEditVal","labelEditVal","positionEditVal","sizeEditVal","updateSetting","cancelBtnContainer","cancelBtn","Pickr","create","el","theme","default","useAsButton","swatches","components","preview","opacity","hue","interaction","hex","rgba","hsla","hsva","cmyk","input","clear","save","ui:dialog","btn:toggle","btn:swatch","btn:last-color","btn:save","btn:cancel","btn:clear","aria:btn:save","aria:btn:cancel","aria:btn:clear","aria:input","aria:palette","aria:hue","aria:opacity","on","color","instance","newSettingUrl","clearAll","each","index","element","document","ready","runtime","openOptionsPage","keydown","event","key","window","close","attr"],"mappings":"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","file":"environment-marker.min.js","sourcesContent":["let inputUrlFragmentPlaceholder = browser.i18n.getMessage(\"inputUrlFragmentPlaceholder\"),\r\n    inputColorPlaceholder = browser.i18n.getMessage(\"inputColorPlaceholder\"),\r\n    inputLabelPlaceholder = browser.i18n.getMessage(\"inputLabelPlaceholder\"),\r\n    positionSelectTopLeft = browser.i18n.getMessage(\"positionSelectTopLeft\"),\r\n    positionSelectTopRight = browser.i18n.getMessage(\"positionSelectTopRight\"),\r\n    positionSelectBottomLeft = browser.i18n.getMessage(\"positionSelectBottomLeft\"),\r\n    positionSelectBottomRight = browser.i18n.getMessage(\"positionSelectBottomRight\"),\r\n    sizeSelectExtraSmall = browser.i18n.getMessage(\"sizeSelectExtraSmall\"),\r\n    sizeSelectSmall = browser.i18n.getMessage(\"sizeSelectSmall\"),\r\n    sizeSelectNormal = browser.i18n.getMessage(\"sizeSelectNormal\"),\r\n    sizeSelectLarge = browser.i18n.getMessage(\"sizeSelectLarge\"),\r\n    sizeSelectExtraLarge = browser.i18n.getMessage(\"sizeSelectExtraLarge\"),\r\n    noticeNoRibbons = browser.i18n.getMessage(\"noticeNoRibbons\"),\r\n    buttonClearAll = browser.i18n.getMessage(\"buttonClearAll\"),\r\n    buttonImportExport = browser.i18n.getMessage(\"buttonImportExport\"),\r\n    errorDuplicateMarker = browser.i18n.getMessage(\"errorDuplicateMarker\"),\r\n    errorLabelEmpty = browser.i18n.getMessage(\"errorLabelEmpty\"),\r\n    errorUrlEmpty = browser.i18n.getMessage(\"errorUrlEmpty\"),\r\n    colorPickerUiDialog = browser.i18n.getMessage(\"colorPickerUiDialog\"),\r\n    colorPickerBtnToggle = browser.i18n.getMessage(\"colorPickerBtnToggle\"),\r\n    colorPickerBtnSwatch = browser.i18n.getMessage(\"colorPickerBtnSwatch\"),\r\n    colorPickerBtnLastColor = browser.i18n.getMessage(\"colorPickerBtnLastColor\"),\r\n    colorPickerBtnSave = browser.i18n.getMessage(\"colorPickerBtnSave\"),\r\n    colorPickerBtnCancel = browser.i18n.getMessage(\"colorPickerBtnCancel\"),\r\n    colorPickerBtnClear = browser.i18n.getMessage(\"colorPickerBtnClear\"),\r\n    colorPickerAriaBtnSave = browser.i18n.getMessage(\"colorPickerAriaBtnSave\"),\r\n    colorPickerAriaBtnCancel = browser.i18n.getMessage(\"colorPickerAriaBtnCancel\"),\r\n    colorPickerAriaBtnClear = browser.i18n.getMessage(\"colorPickerAriaBtnClear\"),\r\n    colorPickerAriaInput = browser.i18n.getMessage(\"colorPickerAriaInput\"),\r\n    colorPickerAriaPalette = browser.i18n.getMessage(\"colorPickerAriaPalette\"),\r\n    colorPickerAriaHue = browser.i18n.getMessage(\"colorPickerAriaHue\"),\r\n    colorPickerAriaOpacity = browser.i18n.getMessage(\"colorPickerAriaOpacity\");\r\n\r\nlet pickr = null;\r\nconst hide = 'none';\r\nconst show = 'block';\r\nconst positionsMap = [\r\n  {value: 'top-left', label: positionSelectTopLeft},\r\n  {value: 'top-right', label: positionSelectTopRight},\r\n  {value: 'bottom-left', label: positionSelectBottomLeft},\r\n  {value: 'bottom-right', label: positionSelectBottomRight}\r\n];\r\nconst sizesMap = [\r\n  {value: 'extra-small', label: sizeSelectExtraSmall},\r\n  {value: 'small', label: sizeSelectSmall},\r\n  {value: 'normal', label: sizeSelectNormal},\r\n  {value: 'large', label: sizeSelectLarge},\r\n  {value: 'extra-large', label: sizeSelectExtraLarge}\r\n];\r\n\r\nfunction onError(error) {\r\n  console.log(error);\r\n}\r\n\r\nfunction truncateString(str, num) {\r\n  if (str.length <= num) {\r\n    return str\r\n  }\r\n  return str.slice(0, num) + '...'\r\n}\r\n\r\nfunction initialize() {\r\n  browser.storage.local.get(null).then((results) => {\r\n    let settingsUrls = Object.keys(results);\r\n    settingsUrls.length > 0 ? showOrHideEmptyNotice(hide) : showOrHideEmptyNotice(show);\r\n    for (let settingUrl of settingsUrls) {\r\n      displaySetting(settingUrl, results[settingUrl][0], results[settingUrl][1], results[settingUrl][2], results[settingUrl][3]);\r\n    }\r\n  }, onError);\r\n}\r\n\r\nfunction showOrHideEmptyNotice(action = null) {\r\n  if (action !== show && action !== hide) {\r\n    browser.storage.local.get(null).then((results) => {\r\n      let settingsUrls = Object.keys(results);\r\n      $('.empty-notice').css('display', settingsUrls.length > 0 ? 'none' : 'block');\r\n    }, onError);\r\n  } else {\r\n    $('.empty-notice').css('display', action);\r\n  }\r\n}\r\n\r\n/* Show error message */\r\nfunction showMessage(textMsg, errorFlag = false) {\r\n  let messageClass = errorFlag ? 'alert-danger' : 'alert-success';\r\n  if ($('.outer-wrapper .message-container .alert').length) {\r\n    $('.outer-wrapper .message-container .alert').remove();\r\n    $('.outer-wrapper .message-container').append('<div class=\"alert ' + messageClass + ' col-12\">' + textMsg + '</div>');\r\n  } else {\r\n    $('.outer-wrapper .message-container').append('<div class=\"alert ' + messageClass + ' col-12\">' + textMsg + '</div>');\r\n  }\r\n}\r\n\r\n/* Add a setting to the display and storage */\r\nfunction saveSettings() {\r\n  let settingUrl = $('.settings-input #url').val(),\r\n      settingColor = pickr.getSelectedColor().toHEXA().toString(0),\r\n      settingLabel = $('.settings-input #label').val(),\r\n      settingPosition = $('.settings-input #position').val(),\r\n      settingSize = $('.settings-input #size').val();\r\n\r\n  if (settingUrl !== '' && settingColor !== '' && settingLabel !== '') {\r\n    browser.storage.local.get(settingUrl).then((result) => {\r\n      let objTest = Object.keys(result);\r\n\r\n      if (objTest.length < 1) {\r\n        if ($('.outer-wrapper .message-container .alert').length) {\r\n          $('.outer-wrapper .message-container .alert').remove();\r\n        }\r\n\r\n        $('.settings-input #url').val('');\r\n        $('.settings-input #label').val('');\r\n        $('.settings-input #position').val('top-left');\r\n        $('.settings-input #size').val('normal');\r\n\r\n        storeSetting(settingUrl, settingColor, settingLabel, settingPosition, settingSize);\r\n      } else {\r\n        // Duplicate marker error message\r\n        showMessage(errorDuplicateMarker);\r\n      }\r\n    }, onError);\r\n  } else {\r\n    // Empty input error message\r\n    settingLabel === '' ? showMessage(errorLabelEmpty) : showMessage(errorUrlEmpty);\r\n  }\r\n}\r\n\r\n/* Store a new setting in local storage */\r\nfunction storeSetting(settingUrl, settingColor, settingLabel, settingPosition, settingSize) {\r\n  browser.storage.local.set({ [settingUrl] : [settingColor, settingLabel, settingPosition, settingSize] }).then(() => {\r\n    showOrHideEmptyNotice(hide);\r\n    displaySetting(settingUrl, settingColor, settingLabel, settingPosition, settingSize);\r\n  }, onError);\r\n}\r\n\r\n/* Display a setting in the setting box */\r\nfunction displaySetting(settingUrl, settingColor, settingLabel, settingPosition, settingSize) {\r\n  let settingPositionDisplay = positionsMap.reduce(function(accumulator, currentValue) {\r\n    if (currentValue.value === settingPosition) {\r\n      accumulator = currentValue.label;\r\n    }\r\n    return accumulator;\r\n  }, {});\r\n\r\n  let settingSizeDisplay = sizesMap.reduce(function(accumulator, currentValue) {\r\n    if (currentValue.value === settingSize) {\r\n      accumulator = currentValue.label;\r\n    }\r\n    return accumulator;\r\n  }, {});\r\n\r\n  let innerSettingsContainer = $( \"<div/>\", { \"class\": \"setting\" });\r\n  let displayContainer = $( \"<div/>\", { \"class\": \"row no-gutters mb-2 display-container\" });\r\n\r\n  let displayLabelUrl = $( \"<div/>\", {\r\n    \"class\": \"col-10 pr-2 display-labelUrl\",\r\n    text: truncateString(settingLabel, 35) + ' (' + truncateString(settingUrl, 35) + ') ' + settingSizeDisplay + ' at ' + settingPositionDisplay,\r\n    click: function() {\r\n      displayContainer.hide();\r\n      editContainer.show();\r\n    }\r\n  });\r\n\r\n  let displayColor = $( \"<div/>\", {\r\n    \"class\": \"col-1 pr-2 display-color\",\r\n    html: '<div style=\"background-color: ' + settingColor + ';\"></div>',\r\n    click: function() {\r\n      displayContainer.hide();\r\n      editContainer.show();\r\n    }\r\n  });\r\n\r\n  let deleteBtnContainer = $( \"<div/>\", {\r\n    \"class\": \"col-1 display-delete\"\r\n  });\r\n\r\n  let deleteBtn = $( \"<button/>\", {\r\n    \"class\": \"btn btn-danger btn-sm delete\",\r\n    html: '<i class=\"fas fa-trash fa-lg\"></i>',\r\n    click: function() {\r\n      $(this).parent().parent().parent().remove();\r\n      browser.storage.local.remove(settingUrl);\r\n      showOrHideEmptyNotice();\r\n    }\r\n  });\r\n\r\n  let editContainer = $( \"<div/>\", {\r\n    \"class\": \"row no-gutters mb-2 edit-container\",\r\n    \"style\": \"display: none;\"\r\n  });\r\n\r\n  let editUrlInputContainer = $( \"<div/>\", {\r\n    \"class\": \"col-10 pr-1 mb-2 edit-url-container\"\r\n  });\r\n\r\n  let editUrlInput = $( \"<input/>\", {\r\n    \"class\": \"form-control edit-url\",\r\n    value: settingUrl\r\n  });\r\n\r\n  let editColorInputContainer = $( \"<div/>\", {\r\n    \"class\": \"col-1 pr-1 mb-2 edit-color\"\r\n  });\r\n\r\n  let editColorInput = $( \"<input/>\", {\r\n    \"class\": \"color-picker\",\r\n    value: settingColor\r\n  });\r\n\r\n  let editLabelInputContainer = $( \"<div/>\", {\r\n    \"class\": \"col-5 pr-2 edit-label-container\"\r\n  });\r\n\r\n  let editLabelInput = $( \"<input/>\", {\r\n    \"class\": \"form-control edit-label\",\r\n    value: settingLabel\r\n  });\r\n\r\n  let optionsSelectPositionContainer = $( \"<div/>\", {\r\n    \"class\": \"col-3 pr-2 edit-position-container\"\r\n  });\r\n\r\n  let optionsSelectPosition = $( \"<select/>\", {\r\n    \"class\": \"form-control edit-position\"\r\n  });\r\n\r\n  for (let i = 0; i < positionsMap.length; i++) {\r\n    if (positionsMap[i].value === settingPosition) {\r\n      optionsSelectPosition.append(new Option(positionsMap[i].label, positionsMap[i].value, true, true));\r\n    } else {\r\n      optionsSelectPosition.append(new Option(positionsMap[i].label, positionsMap[i].value));\r\n    }\r\n  }\r\n\r\n  let optionsSelectSizeContainer = $( \"<div/>\", {\r\n    \"class\": \"col-3 pr-2 edit-size-container\"\r\n  });\r\n\r\n  let optionsSelectSize = $( \"<select/>\", {\r\n    \"class\": \"form-control edit-size\"\r\n  });\r\n\r\n  for (let i = 0; i < sizesMap.length; i++) {\r\n    // For backwards compatibility for users that already have ribbons configured.\r\n    // @TODO: Remove sometime in the future\r\n    if (settingSize === undefined) {\r\n      settingSize = 'normal'\r\n    }\r\n\r\n    if (sizesMap[i].value === settingSize) {\r\n      optionsSelectSize.append(new Option(sizesMap[i].label, sizesMap[i].value, true, true));\r\n    } else {\r\n      optionsSelectSize.append(new Option(sizesMap[i].label, sizesMap[i].value));\r\n    }\r\n  }\r\n\r\n  let updateBtnContainer = $( \"<div/>\", {\r\n    \"class\": \"col-1 mb-2 edit-delete\"\r\n  });\r\n\r\n  let updateBtn = $( \"<button/>\", {\r\n    \"class\": \"btn btn-success btn-sm update\",\r\n    html: '<i class=\"fas fa-pencil-alt fa-lg\"></i>',\r\n    click: function() {\r\n      let urlEditVal = editUrlInput.val(),\r\n          colorEditVal = editColorInput.val(),\r\n          labelEditVal = editLabelInput.val(),\r\n          positionEditVal = optionsSelectPosition.val(),\r\n          sizeEditVal = optionsSelectSize.val();\r\n\r\n      if (urlEditVal !== settingUrl ||\r\n          colorEditVal !== settingColor ||\r\n          labelEditVal !== settingLabel ||\r\n          positionEditVal !== settingPosition ||\r\n          sizeEditVal !== settingSize) {\r\n        updateSetting(settingUrl, urlEditVal, colorEditVal, labelEditVal, positionEditVal, sizeEditVal);\r\n        innerSettingsContainer.remove();\r\n      }\r\n    }\r\n  });\r\n\r\n  let cancelBtnContainer = $( \"<div/>\", {\r\n    \"class\": \"col-1 edit-cancel\"\r\n  });\r\n\r\n  let cancelBtn = $( \"<button/>\", {\r\n    \"class\": \"btn btn-secondary btn-sm cancel\",\r\n    html: '<i class=\"fas fa-times fa-lg\"></i>',\r\n    click: function() {\r\n      displayContainer.show();\r\n      editContainer.hide();\r\n      editUrlInput.val(settingUrl);\r\n      editColorInput.val(settingColor);\r\n      editLabelInput.val(settingLabel);\r\n      optionsSelectPosition.val(settingPosition);\r\n      optionsSelectSize.val(settingSize);\r\n    }\r\n  });\r\n\r\n  editUrlInputContainer.append(editUrlInput);\r\n  editColorInputContainer.append(editColorInput);\r\n  optionsSelectPositionContainer.append(optionsSelectPosition);\r\n  optionsSelectSizeContainer.append(optionsSelectSize);\r\n  updateBtnContainer.append(updateBtn);\r\n  editLabelInputContainer.append(editLabelInput);\r\n  cancelBtnContainer.append(cancelBtn);\r\n\r\n  editContainer.append(editUrlInputContainer);\r\n  editContainer.append(editColorInputContainer);\r\n  editContainer.append(updateBtnContainer);\r\n  editContainer.append(editLabelInputContainer);\r\n  editContainer.append(optionsSelectPositionContainer);\r\n  editContainer.append(optionsSelectSizeContainer);\r\n  editContainer.append(cancelBtnContainer);\r\n\r\n  deleteBtnContainer.append(deleteBtn);\r\n\r\n  displayContainer.append(displayLabelUrl);\r\n  displayContainer.append(displayColor);\r\n  displayContainer.append(deleteBtnContainer);\r\n\r\n  innerSettingsContainer.append(displayContainer);\r\n  innerSettingsContainer.append(editContainer);\r\n\r\n  $('.settings-container').append(innerSettingsContainer);\r\n\r\n  let pickr = Pickr.create({\r\n    el: editColorInput[0],\r\n    theme: 'nano',\r\n    default: settingColor,\r\n    useAsButton: false,\r\n    swatches: [\r\n      'rgba(244, 67,  54, 1)',\r\n      'rgba(233, 30,  99, 1)',\r\n      'rgba(156, 39, 176, 1)',\r\n      'rgba(103, 58, 183, 1)',\r\n      'rgba(63,  81, 181, 1)',\r\n      'rgba(33, 150, 243, 1)',\r\n      'rgba(3,  169, 244, 1)'\r\n    ],\r\n    components: {\r\n      preview: true,\r\n      opacity: false,\r\n      hue: true,\r\n      interaction: {\r\n        hex: false,\r\n        rgba: false,\r\n        hsla: false,\r\n        hsva: false,\r\n        cmyk: false,\r\n        input: true,\r\n        clear: false,\r\n        save: true\r\n      }\r\n    },\r\n    i18n: {\r\n      'ui:dialog': colorPickerUiDialog,\r\n      'btn:toggle': colorPickerBtnToggle,\r\n      'btn:swatch': colorPickerBtnSwatch,\r\n      'btn:last-color': colorPickerBtnLastColor,\r\n      'btn:save': colorPickerBtnSave,\r\n      'btn:cancel': colorPickerBtnCancel,\r\n      'btn:clear': colorPickerBtnClear,\r\n      'aria:btn:save': colorPickerAriaBtnSave,\r\n      'aria:btn:cancel': colorPickerAriaBtnCancel,\r\n      'aria:btn:clear': colorPickerAriaBtnClear,\r\n      'aria:input': colorPickerAriaInput,\r\n      'aria:palette': colorPickerAriaPalette,\r\n      'aria:hue': colorPickerAriaHue,\r\n      'aria:opacity': colorPickerAriaOpacity\r\n    }\r\n  });\r\n\r\n  pickr.on('save', (color, instance) => {\r\n    editColorInput.val(color.toHEXA().toString(0));\r\n    instance.hide();\r\n  });\r\n}\r\n\r\n/* Update settings */\r\nfunction updateSetting(settingUrl, newSettingUrl, settingColor, settingLabel, settingPosition, settingSize) {\r\n  browser.storage.local.set({ [newSettingUrl] : [settingColor, settingLabel, settingPosition, settingSize] }).then(() => {\r\n    if (settingUrl !== newSettingUrl) {\r\n      // Changed URL\r\n      browser.storage.local.remove(settingUrl).then(() => {\r\n        displaySetting(newSettingUrl, settingColor, settingLabel, settingPosition, settingSize);\r\n      }, onError);\r\n    } else {\r\n      // Change settings\r\n      displaySetting(newSettingUrl, settingColor, settingLabel, settingPosition, settingSize);\r\n    }\r\n  }, onError);\r\n}\r\n\r\n/* Clear all settings from the display and storage */\r\nfunction clearAll() {\r\n  $('.settings-container .setting').each((index, element) => {\r\n    element.remove();\r\n  });\r\n  browser.storage.local.clear();\r\n  showOrHideEmptyNotice(show);\r\n}\r\n\r\n$(document).ready(() => {\r\n  /* Display previously saved markers on startup */\r\n  initialize();\r\n\r\n  $('.save').click(() => {\r\n    saveSettings();\r\n  });\r\n\r\n  $('.clear').click(() => {\r\n    clearAll();\r\n  });\r\n\r\n  $('.import-export').click(() => {\r\n    browser.runtime.openOptionsPage();\r\n  });\r\n\r\n  $(document).keydown(function(event) {\r\n    // Enter\r\n    if (event.key === 'Enter' || event.key === 'NumpadEnter') {\r\n      saveSettings();\r\n    }\r\n\r\n    // Escape\r\n    if (event.key === 'Escape') {\r\n      window.close();\r\n    } else {\r\n      return true;\r\n    }\r\n  });\r\n\r\n  pickr = Pickr.create({\r\n    el: '.color-picker',\r\n    theme: 'nano',\r\n    useAsButton: false,\r\n    swatches: [\r\n      'rgba(244, 67,  54, 1)',\r\n      'rgba(233, 30,  99, 1)',\r\n      'rgba(156, 39, 176, 1)',\r\n      'rgba(103, 58, 183, 1)',\r\n      'rgba(63,  81, 181, 1)',\r\n      'rgba(33, 150, 243, 1)',\r\n      'rgba(3,  169, 244, 1)'\r\n    ],\r\n    components: {\r\n      preview: true,\r\n      opacity: false,\r\n      hue: true,\r\n      interaction: {\r\n        hex: false,\r\n        rgba: false,\r\n        hsla: false,\r\n        hsva: false,\r\n        cmyk: false,\r\n        input: true,\r\n        clear: false,\r\n        save: true\r\n      }\r\n    },\r\n    i18n: {\r\n      'ui:dialog': colorPickerUiDialog,\r\n      'btn:toggle': colorPickerBtnToggle,\r\n      'btn:swatch': colorPickerBtnSwatch,\r\n      'btn:last-color': colorPickerBtnLastColor,\r\n      'btn:save': colorPickerBtnSave,\r\n      'btn:cancel': colorPickerBtnCancel,\r\n      'btn:clear': colorPickerBtnClear,\r\n      'aria:btn:save': colorPickerAriaBtnSave,\r\n      'aria:btn:cancel': colorPickerAriaBtnCancel,\r\n      'aria:btn:clear': colorPickerAriaBtnClear,\r\n      'aria:input': colorPickerAriaInput,\r\n      'aria:palette': colorPickerAriaPalette,\r\n      'aria:hue': colorPickerAriaHue,\r\n      'aria:opacity': colorPickerAriaOpacity\r\n    }\r\n  });\r\n\r\n  pickr.on('save', (color, instance) => {\r\n    //$('.settings-input #color').val(color.toHEXA().toString(0));\r\n    instance.hide();\r\n  });\r\n\r\n  $('.empty-notice').html(noticeNoRibbons);\r\n  $('.clear').html(buttonClearAll);\r\n  $('.import-export').html(buttonImportExport);\r\n\r\n  $('#url').attr('placeholder', inputUrlFragmentPlaceholder);\r\n  $('#color').attr('placeholder', inputColorPlaceholder);\r\n  $('#label').attr('placeholder', inputLabelPlaceholder);\r\n\r\n  $('#position option[value=\"top-left\"]').html(positionSelectTopLeft);\r\n  $('#position option[value=\"top-right\"]').html(positionSelectTopRight);\r\n  $('#position option[value=\"bottom-left\"]').html(positionSelectBottomLeft);\r\n  $('#position option[value=\"bottom-right\"]').html(positionSelectBottomRight);\r\n\r\n  $('#size option[value=\"extra-small\"]').html(sizeSelectExtraSmall);\r\n  $('#size option[value=\"small\"]').html(sizeSelectSmall);\r\n  $('#size option[value=\"normal\"]').html(sizeSelectNormal);\r\n  $('#size option[value=\"large\"]').html(sizeSelectLarge);\r\n  $('#size option[value=\"extra-large\"]').html(sizeSelectExtraLarge);\r\n});\r\n"]}