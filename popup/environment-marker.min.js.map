{"version":3,"sources":["environment-marker.js"],"names":["inputUrlFragmentPlaceholder","browser","i18n","getMessage","inputColorPlaceholder","inputLabelPlaceholder","positionSelectTopLeft","positionSelectTopRight","positionSelectBottomLeft","positionSelectBottomRight","sizeSelectExtraSmall","sizeSelectSmall","sizeSelectNormal","sizeSelectLarge","sizeSelectExtraLarge","noticeNoRibbons","buttonClearAll","buttonImportExport","errorDuplicateMarker","errorLabelEmpty","errorUrlEmpty","colorPickerUiDialog","colorPickerBtnToggle","colorPickerBtnSwatch","colorPickerBtnLastColor","colorPickerBtnSave","colorPickerBtnCancel","colorPickerBtnClear","colorPickerAriaBtnSave","colorPickerAriaBtnCancel","colorPickerAriaBtnClear","colorPickerAriaInput","colorPickerAriaPalette","colorPickerAriaHue","colorPickerAriaOpacity","displayAt","pickr","colorSwatches","swatchesKey","markersKey","maxSwatches","hide","show","positionsMap","value","label","sizesMap","onError","error","console","log","truncateString","str","num","length","slice","initialize","storage","local","get","then","storedResults","storedArray","showOrHideEmptyNotice","storedObject","displaySetting","settingUrl","settingColor","settingLabel","settingPosition","settingSize","action","$","css","saveSwatches","swatches","set","[object Object]","showMessage","textMsg","errorFlag","messageClass","remove","append","searchStoredMarkers","url","i","saveSettings","val","getSelectedColor","toHEXA","toString","storeSetting","storeObject","unshift","updateSetting","newSettingUrl","updatedArray","filter","obj","deleteSetting","filteredArray","clearAll","each","index","element","settingPositionDisplay","reduce","accumulator","currentValue","settingSizeDisplay","undefined","innerSettingsContainer","class","displayContainer","displayLabelUrl","text","click","editContainer","displayColor","html","deleteBtnContainer","deleteBtn","this","parent","style","editUrlInputContainer","editUrlInput","editColorInputContainer","editColorInput","editLabelInputContainer","editLabelInput","optionsSelectPositionContainer","optionsSelectPosition","Option","optionsSelectSizeContainer","optionsSelectSize","updateBtnContainer","updateBtn","urlEditVal","colorEditVal","labelEditVal","positionEditVal","sizeEditVal","cancelBtnContainer","cancelBtn","storedSwatchesArray","Pickr","create","el","theme","default","useAsButton","components","preview","opacity","hue","interaction","hex","rgba","hsla","hsva","cmyk","input","clear","save","ui:dialog","btn:toggle","btn:swatch","btn:last-color","btn:save","btn:cancel","btn:clear","aria:btn:save","aria:btn:cancel","aria:btn:clear","aria:input","aria:palette","aria:hue","aria:opacity","on","color","instance","swatchList","getSwatches","includes","toRGBA","pop","setSwatches","prototype","_swatchColors","arr","swatch","push","removeSwatch","forEach","addSwatch","document","ready","runtime","openOptionsPage","keydown","event","key","window","close","attr"],"mappings":"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","file":"environment-marker.min.js","sourcesContent":["let inputUrlFragmentPlaceholder = browser.i18n.getMessage(\"inputUrlFragmentPlaceholder\"),\r\n    inputColorPlaceholder = browser.i18n.getMessage(\"inputColorPlaceholder\"),\r\n    inputLabelPlaceholder = browser.i18n.getMessage(\"inputLabelPlaceholder\"),\r\n    positionSelectTopLeft = browser.i18n.getMessage(\"positionSelectTopLeft\"),\r\n    positionSelectTopRight = browser.i18n.getMessage(\"positionSelectTopRight\"),\r\n    positionSelectBottomLeft = browser.i18n.getMessage(\"positionSelectBottomLeft\"),\r\n    positionSelectBottomRight = browser.i18n.getMessage(\"positionSelectBottomRight\"),\r\n    sizeSelectExtraSmall = browser.i18n.getMessage(\"sizeSelectExtraSmall\"),\r\n    sizeSelectSmall = browser.i18n.getMessage(\"sizeSelectSmall\"),\r\n    sizeSelectNormal = browser.i18n.getMessage(\"sizeSelectNormal\"),\r\n    sizeSelectLarge = browser.i18n.getMessage(\"sizeSelectLarge\"),\r\n    sizeSelectExtraLarge = browser.i18n.getMessage(\"sizeSelectExtraLarge\"),\r\n    noticeNoRibbons = browser.i18n.getMessage(\"noticeNoRibbons\"),\r\n    buttonClearAll = browser.i18n.getMessage(\"buttonClearAll\"),\r\n    buttonImportExport = browser.i18n.getMessage(\"buttonImportExport\"),\r\n    errorDuplicateMarker = browser.i18n.getMessage(\"errorDuplicateMarker\"),\r\n    errorLabelEmpty = browser.i18n.getMessage(\"errorLabelEmpty\"),\r\n    errorUrlEmpty = browser.i18n.getMessage(\"errorUrlEmpty\"),\r\n    colorPickerUiDialog = browser.i18n.getMessage(\"colorPickerUiDialog\"),\r\n    colorPickerBtnToggle = browser.i18n.getMessage(\"colorPickerBtnToggle\"),\r\n    colorPickerBtnSwatch = browser.i18n.getMessage(\"colorPickerBtnSwatch\"),\r\n    colorPickerBtnLastColor = browser.i18n.getMessage(\"colorPickerBtnLastColor\"),\r\n    colorPickerBtnSave = browser.i18n.getMessage(\"colorPickerBtnSave\"),\r\n    colorPickerBtnCancel = browser.i18n.getMessage(\"colorPickerBtnCancel\"),\r\n    colorPickerBtnClear = browser.i18n.getMessage(\"colorPickerBtnClear\"),\r\n    colorPickerAriaBtnSave = browser.i18n.getMessage(\"colorPickerAriaBtnSave\"),\r\n    colorPickerAriaBtnCancel = browser.i18n.getMessage(\"colorPickerAriaBtnCancel\"),\r\n    colorPickerAriaBtnClear = browser.i18n.getMessage(\"colorPickerAriaBtnClear\"),\r\n    colorPickerAriaInput = browser.i18n.getMessage(\"colorPickerAriaInput\"),\r\n    colorPickerAriaPalette = browser.i18n.getMessage(\"colorPickerAriaPalette\"),\r\n    colorPickerAriaHue = browser.i18n.getMessage(\"colorPickerAriaHue\"),\r\n    colorPickerAriaOpacity = browser.i18n.getMessage(\"colorPickerAriaOpacity\"),\r\n    displayAt = browser.i18n.getMessage(\"displayAt\");\r\n\r\nlet pickr = null,\r\n    colorSwatches = [\r\n      'rgba(244, 67,  54, 1)',\r\n      'rgba(233, 30,  99, 1)',\r\n      'rgba(156, 39, 176, 1)',\r\n      'rgba(103, 58, 183, 1)',\r\n      'rgba(63,  81, 181, 1)',\r\n      'rgba(33, 150, 243, 1)',\r\n      'rgba(3,  169, 244, 1)'\r\n    ];\r\nconst swatchesKey = '__em-swatches__';\r\nconst markersKey = '__em-markers__';\r\nconst maxSwatches = 7;\r\nconst hide = 'none';\r\nconst show = 'block';\r\nconst positionsMap = [\r\n  {value: 'top-left', label: positionSelectTopLeft},\r\n  {value: 'top-right', label: positionSelectTopRight},\r\n  {value: 'bottom-left', label: positionSelectBottomLeft},\r\n  {value: 'bottom-right', label: positionSelectBottomRight}\r\n];\r\nconst sizesMap = [\r\n  {value: 'extra-small', label: sizeSelectExtraSmall},\r\n  {value: 'small', label: sizeSelectSmall},\r\n  {value: 'normal', label: sizeSelectNormal},\r\n  {value: 'large', label: sizeSelectLarge},\r\n  {value: 'extra-large', label: sizeSelectExtraLarge}\r\n];\r\n\r\nPickr.prototype.getSwatches = function() {\r\n  return this._swatchColors.reduce((arr, swatch) => {\r\n    arr.push(swatch.color.toRGBA().toString(0));\r\n    return arr\r\n  }, []);\r\n}\r\n\r\nPickr.prototype.setSwatches = function(swatches) {\r\n  if (!swatches.length) return;\r\n  for (let i = this._swatchColors.length - 1; i > -1; i--) {\r\n    this.removeSwatch(i);\r\n  }\r\n  swatches.forEach(swatch => this.addSwatch(swatch));\r\n}\r\n\r\nfunction onError(error) {\r\n  console.log(error);\r\n}\r\n\r\nfunction truncateString(str, num) {\r\n  if (str.length <= num) {\r\n    return str\r\n  }\r\n  return str.slice(0, num) + '...'\r\n}\r\n\r\nfunction initialize() {\r\n  browser.storage.local.get(markersKey).then((storedResults) => {\r\n    let storedArray = storedResults[markersKey] || [];\r\n    if (storedArray.length > 0) {\r\n      showOrHideEmptyNotice(hide);\r\n      for (let storedObject of storedArray) {\r\n        displaySetting(\r\n            storedObject.settingUrl,\r\n            storedObject.settingColor,\r\n            storedObject.settingLabel,\r\n            storedObject.settingPosition,\r\n            storedObject.settingSize\r\n        );\r\n      }\r\n    } else {\r\n      showOrHideEmptyNotice(show);\r\n    }\r\n  }, onError);\r\n}\r\n\r\nfunction showOrHideEmptyNotice(action = null) {\r\n  if (action !== show && action !== hide) {\r\n    browser.storage.local.get(markersKey).then((storedArray) => {\r\n      $('.empty-notice').css('display', storedArray[markersKey].length > 0 ? 'none' : 'block');\r\n    }, onError);\r\n  } else {\r\n    $('.empty-notice').css('display', action);\r\n  }\r\n}\r\n\r\nfunction saveSwatches(swatches) {\r\n  browser.storage.local.set({ [swatchesKey] : swatches }).then(null, onError);\r\n}\r\n\r\n/* Show error or success messages */\r\nfunction showMessage(textMsg, errorFlag = false) {\r\n  let messageClass = errorFlag ? 'alert-danger' : 'alert-success';\r\n  if ($('.outer-wrapper .message-container .alert').length) {\r\n    $('.outer-wrapper .message-container .alert').remove();\r\n    $('.outer-wrapper .message-container').append('<div class=\"alert ' + messageClass + ' col-12\">' + textMsg + '</div>');\r\n  } else {\r\n    $('.outer-wrapper .message-container').append('<div class=\"alert ' + messageClass + ' col-12\">' + textMsg + '</div>');\r\n  }\r\n}\r\n\r\n/* Search stored array of object for the url */\r\nfunction searchStoredMarkers(url, storedArray) {\r\n  for (let i = 0; i < storedArray.length; i++) {\r\n    if (storedArray[i].settingUrl === url) {\r\n      return storedArray[i];\r\n    }\r\n  }\r\n}\r\n\r\n/* Add a setting to the display and storage */\r\nfunction saveSettings() {\r\n  let settingUrl = $('.settings-input #url').val(),\r\n      settingColor = pickr.getSelectedColor().toHEXA().toString(0),\r\n      settingLabel = $('.settings-input #label').val(),\r\n      settingPosition = $('.settings-input #position').val(),\r\n      settingSize = $('.settings-input #size').val();\r\n\r\n  if (settingUrl !== '' && settingColor !== '' && settingLabel !== '') {\r\n    browser.storage.local.get(markersKey).then((storedResults) => {\r\n      let storedArray = storedResults[markersKey] || [],\r\n          objectExists = searchStoredMarkers(settingUrl, storedArray);\r\n\r\n      if (!objectExists) {\r\n        if ($('.outer-wrapper .message-container .alert').length) {\r\n          $('.outer-wrapper .message-container .alert').remove();\r\n        }\r\n\r\n        $('.settings-input #url').val('');\r\n        $('.settings-input #label').val('');\r\n        $('.settings-input #position').val('top-left');\r\n        $('.settings-input #size').val('normal');\r\n\r\n        storeSetting(storedResults, settingUrl, settingColor, settingLabel, settingPosition, settingSize);\r\n      } else {\r\n        // Duplicate marker error message\r\n        showMessage(errorDuplicateMarker);\r\n      }\r\n    }, onError);\r\n  } else {\r\n    // Empty input error message\r\n    settingLabel === '' ? showMessage(errorLabelEmpty) : showMessage(errorUrlEmpty);\r\n  }\r\n}\r\n\r\n/* Store a new setting in local storage */\r\nfunction storeSetting(storedResults, settingUrl, settingColor, settingLabel, settingPosition, settingSize) {\r\n  let storedArray = storedResults[markersKey] || [];\r\n  let storeObject = {\r\n    settingUrl: settingUrl,\r\n    settingColor: settingColor,\r\n    settingLabel: settingLabel,\r\n    settingPosition: settingPosition,\r\n    settingSize: settingSize\r\n  };\r\n\r\n  storedArray.unshift(storeObject);\r\n\r\n  browser.storage.local.set({ [markersKey] : storedArray }).then(() => {\r\n    showOrHideEmptyNotice(hide);\r\n    displaySetting(settingUrl, settingColor, settingLabel, settingPosition, settingSize);\r\n  }, onError);\r\n}\r\n\r\n/* Update settings */\r\nfunction updateSetting(settingUrl, newSettingUrl, settingColor, settingLabel, settingPosition, settingSize) {\r\n  browser.storage.local.get(markersKey).then((storedResults) => {\r\n    let storedArray = storedResults[markersKey] || [],\r\n        settingExists = searchStoredMarkers(settingUrl, storedArray);\r\n\r\n    if (settingExists) {\r\n      let updatedArray = storedArray.filter(function(obj) {\r\n        if (obj.settingUrl === settingUrl) {\r\n          obj.settingUrl = newSettingUrl;\r\n          obj.settingColor = settingColor;\r\n          obj.settingLabel = settingLabel;\r\n          obj.settingPosition = settingPosition;\r\n          obj.settingSize = settingSize;\r\n        }\r\n        return true;\r\n      });\r\n\r\n      browser.storage.local.set({ [markersKey] : updatedArray }).then(() => {\r\n        displaySetting(newSettingUrl, settingColor, settingLabel, settingPosition, settingSize);\r\n      }, onError);\r\n    }\r\n  }, onError);\r\n}\r\n\r\nfunction deleteSetting(settingUrl) {\r\n  browser.storage.local.get(markersKey).then((storedResults) => {\r\n    let storedArray = storedResults[markersKey] || [],\r\n        settingExists = searchStoredMarkers(settingUrl, storedArray);\r\n\r\n    if (settingExists) {\r\n      let filteredArray = storedArray.filter(function(obj) { return obj.settingUrl !== settingUrl; });\r\n      browser.storage.local.set({ [markersKey] : filteredArray }).then(null, onError);\r\n    }\r\n  }, onError);\r\n}\r\n\r\n/* Clear all settings from the display and storage */\r\nfunction clearAll() {\r\n  $('.settings-container .setting').each((index, element) => {\r\n    element.remove();\r\n  });\r\n  browser.storage.local.set({ [markersKey] : [] }).then(null, onError);\r\n  showOrHideEmptyNotice(show);\r\n}\r\n\r\n/* Display a setting in the setting box */\r\nfunction displaySetting(settingUrl, settingColor, settingLabel, settingPosition, settingSize) {\r\n  let settingPositionDisplay = positionsMap.reduce(function(accumulator, currentValue) {\r\n    if (currentValue.value === settingPosition) {\r\n      accumulator = currentValue.label;\r\n    }\r\n    return accumulator;\r\n  }, {});\r\n\r\n  // For backwards compatibility for users that already have ribbons configured.\r\n  // @TODO: Remove sometime in the future\r\n  let settingSizeDisplay = sizeSelectNormal;\r\n  if (settingSize !== undefined) {\r\n    settingSizeDisplay = sizesMap.reduce(function(accumulator, currentValue) {\r\n      if (currentValue.value === settingSize) {\r\n        accumulator = currentValue.label;\r\n      }\r\n      return accumulator;\r\n    }, {});\r\n    settingSize = 'normal';\r\n  }\r\n\r\n  let innerSettingsContainer = $( \"<div/>\", { \"class\": \"setting\" });\r\n  let displayContainer = $( \"<div/>\", { \"class\": \"row no-gutters mb-2 display-container\" });\r\n\r\n  let displayLabelUrl = $( \"<div/>\", {\r\n    \"class\": \"col-10 pr-2 display-labelUrl\",\r\n    text: truncateString(settingLabel, 35) + ' (' + truncateString(settingUrl, 35) + ') ' + settingSizeDisplay + ' ' + displayAt + ' ' + settingPositionDisplay,\r\n    click: function() {\r\n      displayContainer.hide();\r\n      editContainer.show();\r\n    }\r\n  });\r\n\r\n  let displayColor = $( \"<div/>\", {\r\n    \"class\": \"col-1 pr-2 display-color\",\r\n    html: '<div style=\"background-color: ' + settingColor + ';\"></div>',\r\n    click: function() {\r\n      displayContainer.hide();\r\n      editContainer.show();\r\n    }\r\n  });\r\n\r\n  let deleteBtnContainer = $( \"<div/>\", {\r\n    \"class\": \"col-1 display-delete\"\r\n  });\r\n\r\n  let deleteBtn = $( \"<button/>\", {\r\n    \"class\": \"btn btn-danger btn-sm delete\",\r\n    html: '<i class=\"fas fa-trash fa-lg\"></i>',\r\n    click: function() {\r\n      $(this).parent().parent().parent().remove();\r\n      deleteSetting(settingUrl);\r\n      showOrHideEmptyNotice();\r\n    }\r\n  });\r\n\r\n  let editContainer = $( \"<div/>\", {\r\n    \"class\": \"row no-gutters mb-2 edit-container\",\r\n    \"style\": \"display: none;\"\r\n  });\r\n\r\n  let editUrlInputContainer = $( \"<div/>\", {\r\n    \"class\": \"col-10 pr-1 mb-2 edit-url-container\"\r\n  });\r\n\r\n  let editUrlInput = $( \"<input/>\", {\r\n    \"class\": \"form-control edit-url\",\r\n    value: settingUrl\r\n  });\r\n\r\n  let editColorInputContainer = $( \"<div/>\", {\r\n    \"class\": \"col-1 pr-1 mb-2 edit-color\"\r\n  });\r\n\r\n  let editColorInput = $( \"<input/>\", {\r\n    \"class\": \"color-picker\",\r\n    value: settingColor\r\n  });\r\n\r\n  let editLabelInputContainer = $( \"<div/>\", {\r\n    \"class\": \"col-5 pr-2 edit-label-container\"\r\n  });\r\n\r\n  let editLabelInput = $( \"<input/>\", {\r\n    \"class\": \"form-control edit-label\",\r\n    value: settingLabel\r\n  });\r\n\r\n  let optionsSelectPositionContainer = $( \"<div/>\", {\r\n    \"class\": \"col-3 pr-2 edit-position-container\"\r\n  });\r\n\r\n  let optionsSelectPosition = $( \"<select/>\", {\r\n    \"class\": \"form-control edit-position\"\r\n  });\r\n\r\n  for (let i = 0; i < positionsMap.length; i++) {\r\n    if (positionsMap[i].value === settingPosition) {\r\n      optionsSelectPosition.append(new Option(positionsMap[i].label, positionsMap[i].value, true, true));\r\n    } else {\r\n      optionsSelectPosition.append(new Option(positionsMap[i].label, positionsMap[i].value));\r\n    }\r\n  }\r\n\r\n  let optionsSelectSizeContainer = $( \"<div/>\", {\r\n    \"class\": \"col-3 pr-2 edit-size-container\"\r\n  });\r\n\r\n  let optionsSelectSize = $( \"<select/>\", {\r\n    \"class\": \"form-control edit-size\"\r\n  });\r\n\r\n  for (let i = 0; i < sizesMap.length; i++) {\r\n    if (sizesMap[i].value === settingSize) {\r\n      optionsSelectSize.append(new Option(sizesMap[i].label, sizesMap[i].value, true, true));\r\n    } else {\r\n      optionsSelectSize.append(new Option(sizesMap[i].label, sizesMap[i].value));\r\n    }\r\n  }\r\n\r\n  let updateBtnContainer = $( \"<div/>\", {\r\n    \"class\": \"col-1 mb-2 edit-delete\"\r\n  });\r\n\r\n  let updateBtn = $( \"<button/>\", {\r\n    \"class\": \"btn btn-success btn-sm update\",\r\n    html: '<i class=\"fas fa-pencil-alt fa-lg\"></i>',\r\n    click: function() {\r\n      let urlEditVal = editUrlInput.val(),\r\n          colorEditVal = editColorInput.val(),\r\n          labelEditVal = editLabelInput.val(),\r\n          positionEditVal = optionsSelectPosition.val(),\r\n          sizeEditVal = optionsSelectSize.val();\r\n\r\n      if (urlEditVal !== settingUrl ||\r\n          colorEditVal !== settingColor ||\r\n          labelEditVal !== settingLabel ||\r\n          positionEditVal !== settingPosition ||\r\n          sizeEditVal !== settingSize) {\r\n        updateSetting(settingUrl, urlEditVal, colorEditVal, labelEditVal, positionEditVal, sizeEditVal);\r\n        innerSettingsContainer.remove();\r\n      }\r\n    }\r\n  });\r\n\r\n  let cancelBtnContainer = $( \"<div/>\", {\r\n    \"class\": \"col-1 edit-cancel\"\r\n  });\r\n\r\n  let cancelBtn = $( \"<button/>\", {\r\n    \"class\": \"btn btn-secondary btn-sm cancel\",\r\n    html: '<i class=\"fas fa-times fa-lg\"></i>',\r\n    click: function() {\r\n      displayContainer.show();\r\n      editContainer.hide();\r\n      editUrlInput.val(settingUrl);\r\n      editColorInput.val(settingColor);\r\n      editLabelInput.val(settingLabel);\r\n      optionsSelectPosition.val(settingPosition);\r\n      optionsSelectSize.val(settingSize);\r\n    }\r\n  });\r\n\r\n  editUrlInputContainer.append(editUrlInput);\r\n  editColorInputContainer.append(editColorInput);\r\n  optionsSelectPositionContainer.append(optionsSelectPosition);\r\n  optionsSelectSizeContainer.append(optionsSelectSize);\r\n  updateBtnContainer.append(updateBtn);\r\n  editLabelInputContainer.append(editLabelInput);\r\n  cancelBtnContainer.append(cancelBtn);\r\n\r\n  editContainer.append(editUrlInputContainer);\r\n  editContainer.append(editColorInputContainer);\r\n  editContainer.append(updateBtnContainer);\r\n  editContainer.append(editLabelInputContainer);\r\n  editContainer.append(optionsSelectPositionContainer);\r\n  editContainer.append(optionsSelectSizeContainer);\r\n  editContainer.append(cancelBtnContainer);\r\n\r\n  deleteBtnContainer.append(deleteBtn);\r\n\r\n  displayContainer.append(displayLabelUrl);\r\n  displayContainer.append(displayColor);\r\n  displayContainer.append(deleteBtnContainer);\r\n\r\n  innerSettingsContainer.append(displayContainer);\r\n  innerSettingsContainer.append(editContainer);\r\n\r\n  $('.settings-container').append(innerSettingsContainer);\r\n\r\n  browser.storage.local.get(swatchesKey).then((storedSwatchesArray) => {\r\n    if (storedSwatchesArray[swatchesKey]) {\r\n      colorSwatches = storedSwatchesArray[swatchesKey]\r\n    }\r\n\r\n    let pickr = Pickr.create({\r\n      el: editColorInput[0],\r\n      theme: 'nano',\r\n      default: settingColor,\r\n      useAsButton: false,\r\n      swatches: colorSwatches,\r\n      components: {\r\n        preview: true,\r\n        opacity: false,\r\n        hue: true,\r\n        interaction: {\r\n          hex: false,\r\n          rgba: false,\r\n          hsla: false,\r\n          hsva: false,\r\n          cmyk: false,\r\n          input: true,\r\n          clear: false,\r\n          save: true\r\n        }\r\n      },\r\n      i18n: {\r\n        'ui:dialog': colorPickerUiDialog,\r\n        'btn:toggle': colorPickerBtnToggle,\r\n        'btn:swatch': colorPickerBtnSwatch,\r\n        'btn:last-color': colorPickerBtnLastColor,\r\n        'btn:save': colorPickerBtnSave,\r\n        'btn:cancel': colorPickerBtnCancel,\r\n        'btn:clear': colorPickerBtnClear,\r\n        'aria:btn:save': colorPickerAriaBtnSave,\r\n        'aria:btn:cancel': colorPickerAriaBtnCancel,\r\n        'aria:btn:clear': colorPickerAriaBtnClear,\r\n        'aria:input': colorPickerAriaInput,\r\n        'aria:palette': colorPickerAriaPalette,\r\n        'aria:hue': colorPickerAriaHue,\r\n        'aria:opacity': colorPickerAriaOpacity\r\n      }\r\n    });\r\n\r\n    pickr.on('save', (color, instance) => {\r\n      editColorInput.val(color.toHEXA().toString(0));\r\n\r\n      // Add color to the swatch and remove the last color\r\n      let swatchList = pickr.getSwatches();\r\n      let swatchExists = swatchList.includes(color.toRGBA().toString(0));\r\n      if (!swatchExists) {\r\n        if (swatchList.length === maxSwatches) {\r\n          swatchList.pop();\r\n        }\r\n        swatchList.unshift(color.toRGBA().toString(0));\r\n        pickr.setSwatches(swatchList);\r\n        saveSwatches(swatchList);\r\n      }\r\n\r\n      instance.hide();\r\n    });\r\n\r\n    pickr.on('show', () => {\r\n      browser.storage.local.get(swatchesKey).then((storedSwatchesArray) => {\r\n        if (storedSwatchesArray[swatchesKey]) {\r\n          colorSwatches = storedSwatchesArray[swatchesKey]\r\n        }\r\n        pickr.setSwatches(colorSwatches);\r\n      }, onError);\r\n    });\r\n  }, onError);\r\n}\r\n\r\n$(document).ready(() => {\r\n  /* Display previously saved markers on startup */\r\n  initialize();\r\n\r\n  $('.save').click(() => {\r\n    saveSettings();\r\n  });\r\n\r\n  $('.clear').click(() => {\r\n    clearAll();\r\n  });\r\n\r\n  $('.import-export').click(() => {\r\n    browser.runtime.openOptionsPage();\r\n  });\r\n\r\n  $(document).keydown(function(event) {\r\n    // Enter\r\n    if (event.key === 'Enter' || event.key === 'NumpadEnter') {\r\n      saveSettings();\r\n    }\r\n\r\n    // Escape\r\n    if (event.key === 'Escape') {\r\n      window.close();\r\n    } else {\r\n      return true;\r\n    }\r\n  });\r\n\r\n  browser.storage.local.get(swatchesKey).then((storedSwatchesArray) => {\r\n    if (storedSwatchesArray[swatchesKey]) {\r\n      colorSwatches = storedSwatchesArray[swatchesKey]\r\n    }\r\n\r\n    pickr = Pickr.create({\r\n      el: '.color-picker',\r\n      theme: 'nano',\r\n      useAsButton: false,\r\n      swatches: colorSwatches,\r\n      components: {\r\n        preview: true,\r\n        opacity: false,\r\n        hue: true,\r\n        interaction: {\r\n          hex: false,\r\n          rgba: false,\r\n          hsla: false,\r\n          hsva: false,\r\n          cmyk: false,\r\n          input: true,\r\n          clear: false,\r\n          save: true\r\n        }\r\n      },\r\n      i18n: {\r\n        'ui:dialog': colorPickerUiDialog,\r\n        'btn:toggle': colorPickerBtnToggle,\r\n        'btn:swatch': colorPickerBtnSwatch,\r\n        'btn:last-color': colorPickerBtnLastColor,\r\n        'btn:save': colorPickerBtnSave,\r\n        'btn:cancel': colorPickerBtnCancel,\r\n        'btn:clear': colorPickerBtnClear,\r\n        'aria:btn:save': colorPickerAriaBtnSave,\r\n        'aria:btn:cancel': colorPickerAriaBtnCancel,\r\n        'aria:btn:clear': colorPickerAriaBtnClear,\r\n        'aria:input': colorPickerAriaInput,\r\n        'aria:palette': colorPickerAriaPalette,\r\n        'aria:hue': colorPickerAriaHue,\r\n        'aria:opacity': colorPickerAriaOpacity\r\n      }\r\n    });\r\n\r\n    pickr.on('save', (color, instance) => {\r\n      //$('.settings-input #color').val(color.toHEXA().toString(0));\r\n\r\n      // Add color to the swatch and remove the last color\r\n      let swatchList = pickr.getSwatches();\r\n      let swatchExists = swatchList.includes(color.toRGBA().toString(0));\r\n      if (!swatchExists) {\r\n        if (swatchList.length === maxSwatches) {\r\n          swatchList.pop();\r\n        }\r\n        swatchList.unshift(color.toRGBA().toString(0));\r\n        pickr.setSwatches(swatchList);\r\n        saveSwatches(swatchList);\r\n      }\r\n\r\n      instance.hide();\r\n    });\r\n\r\n    pickr.on('show', () => {\r\n      browser.storage.local.get(swatchesKey).then((storedSwatchesArray) => {\r\n        if (storedSwatchesArray[swatchesKey]) {\r\n          colorSwatches = storedSwatchesArray[swatchesKey]\r\n        }\r\n        pickr.setSwatches(colorSwatches);\r\n      }, onError);\r\n    });\r\n  }, onError);\r\n\r\n  $('.empty-notice').html(noticeNoRibbons);\r\n  $('.clear').html(buttonClearAll);\r\n  $('.import-export').html(buttonImportExport);\r\n\r\n  $('#url').attr('placeholder', inputUrlFragmentPlaceholder);\r\n  $('#color').attr('placeholder', inputColorPlaceholder);\r\n  $('#label').attr('placeholder', inputLabelPlaceholder);\r\n\r\n  $('#position option[value=\"top-left\"]').html(positionSelectTopLeft);\r\n  $('#position option[value=\"top-right\"]').html(positionSelectTopRight);\r\n  $('#position option[value=\"bottom-left\"]').html(positionSelectBottomLeft);\r\n  $('#position option[value=\"bottom-right\"]').html(positionSelectBottomRight);\r\n\r\n  $('#size option[value=\"extra-small\"]').html(sizeSelectExtraSmall);\r\n  $('#size option[value=\"small\"]').html(sizeSelectSmall);\r\n  $('#size option[value=\"normal\"]').html(sizeSelectNormal);\r\n  $('#size option[value=\"large\"]').html(sizeSelectLarge);\r\n  $('#size option[value=\"extra-large\"]').html(sizeSelectExtraLarge);\r\n});\r\n"]}