{"version":3,"sources":["environment-marker.js"],"names":["hide","show","positionsMap","value","label","pickr","onError","error","console","log","truncateString","str","num","length","slice","initialize","browser","storage","local","get","then","results","settingsUrls","Object","keys","showOrHideEmptyNotice","settingUrl","displaySetting","action","$","css","showErrorMessage","textMsg","remove","append","saveSettings","val","settingColor","getSelectedColor","toHEXA","toString","settingLabel","settingPosition","result","storeSetting","set","[object Object]","settingPositionDisplay","reduce","accumulator","currentValue","innerSettingsContainer","class","displayContainer","displayLabelUrl","text","click","editContainer","displayColor","html","deleteBtnContainer","deleteBtn","this","parent","style","editUrlInputContainer","editUrlInput","editColorInputContainer","editColorInput","updateBtnContainer","updateBtn","urlEditVal","colorEditVal","labelEditVal","editLabelInput","positionEditVal","optionsSelect","updateSetting","editLabelInputContainer","optionsSelectContainer","i","Option","cancelBtnContainer","cancelBtn","Pickr","create","el","theme","default","useAsButton","swatches","components","preview","opacity","hue","interaction","hex","rgba","hsla","hsva","cmyk","input","clear","save","on","color","instance","newSettingUrl","clearAll","each","index","element","document","ready","runtime","openOptionsPage","keydown","event","key","window","close"],"mappings":"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","file":"environment-marker.min.js","sourcesContent":["const hide = 'none';\r\nconst show = 'block';\r\nconst positionsMap = [\r\n  {value: 'top-left', label: 'Top Left'},\r\n  {value: 'top-right', label: 'Top Right'},\r\n  {value: 'bottom-left', label: 'Bottom Left'},\r\n  {value: 'bottom-right', label: 'Bottom Right'}\r\n];\r\nlet pickr = null;\r\n\r\nfunction onError(error) {\r\n  console.log(error);\r\n}\r\n\r\nfunction truncateString(str, num) {\r\n  if (str.length <= num) {\r\n    return str\r\n  }\r\n  return str.slice(0, num) + '...'\r\n}\r\n\r\nfunction initialize() {\r\n  browser.storage.local.get(null).then((results) => {\r\n    let settingsUrls = Object.keys(results);\r\n    settingsUrls.length > 0 ? showOrHideEmptyNotice(hide) : showOrHideEmptyNotice(show);\r\n    for (let settingUrl of settingsUrls) {\r\n      displaySetting(settingUrl, results[settingUrl][0], results[settingUrl][1], results[settingUrl][2]);\r\n    }\r\n  }, onError);\r\n}\r\n\r\nfunction showOrHideEmptyNotice(action = null) {\r\n  if (action !== show && action !== hide) {\r\n    browser.storage.local.get(null).then((results) => {\r\n      let settingsUrls = Object.keys(results);\r\n      $('.empty-notice').css('display', settingsUrls.length > 0 ? 'none' : 'block');\r\n    }, onError);\r\n  } else {\r\n    $('.empty-notice').css('display', action);\r\n  }\r\n}\r\n\r\n/* Show error message */\r\nfunction showErrorMessage(textMsg) {\r\n  if ($('.outer-wrapper .message-container .error').length) {\r\n    $('.outer-wrapper .message-container .error').remove();\r\n    $('.outer-wrapper .message-container').append('<div class=\"error col-12\">' + textMsg + '</div>');\r\n  } else {\r\n    $('.outer-wrapper .message-container').append('<div class=\"error col-12\">' + textMsg + '</div>');\r\n  }\r\n}\r\n\r\n/* Add a setting to the display and storage */\r\nfunction saveSettings() {\r\n  let settingUrl = $('.settings-input #url').val(),\r\n      settingColor = pickr.getSelectedColor().toHEXA().toString(0),\r\n      settingLabel = $('.settings-input #label').val(),\r\n      settingPosition = $('.settings-input #position').val();\r\n\r\n  if (settingUrl !== '' && settingColor !== '' && settingLabel !== '') {\r\n    browser.storage.local.get(settingUrl).then((result) => {\r\n      let objTest = Object.keys(result);\r\n\r\n      if (objTest.length < 1) {\r\n        if ($('.outer-wrapper .message-container .error').length) {\r\n          $('.outer-wrapper .message-container .error').remove();\r\n        }\r\n\r\n        $('.settings-input #url').val('');\r\n        $('.settings-input #label').val('');\r\n        $('.settings-input #position').val('top-left');\r\n\r\n        storeSetting(settingUrl, settingColor, settingLabel, settingPosition);\r\n      } else {\r\n        // Duplicate marker error message\r\n        showErrorMessage('Marker for this URL already exists!');\r\n      }\r\n    }, onError);\r\n  } else {\r\n    // Empty input error message\r\n    settingLabel === '' ? showErrorMessage('Enter Label !') : showErrorMessage('Enter URL !');\r\n  }\r\n}\r\n\r\n/* Store a new setting in local storage */\r\nfunction storeSetting(settingUrl, settingColor, settingLabel, settingPosition) {\r\n  browser.storage.local.set({ [settingUrl] : [settingColor, settingLabel, settingPosition] }).then(() => {\r\n    showOrHideEmptyNotice(hide);\r\n    displaySetting(settingUrl, settingColor, settingLabel, settingPosition);\r\n  }, onError);\r\n}\r\n\r\n/* Display a setting in the setting box */\r\nfunction displaySetting(settingUrl, settingColor, settingLabel, settingPosition) {\r\n  let settingPositionDisplay = positionsMap.reduce(function(accumulator, currentValue) {\r\n    if (currentValue.value == settingPosition) {\r\n      accumulator = currentValue.label;\r\n    }\r\n    return accumulator;\r\n  }, {});\r\n\r\n  let innerSettingsContainer = $( \"<div/>\", { \"class\": \"setting\" });\r\n  let displayContainer = $( \"<div/>\", { \"class\": \"row no-gutters mb-2 display-container\" });\r\n\r\n  let displayLabelUrl = $( \"<div/>\", {\r\n    \"class\": \"col-10 pr-2 display-labelUrl\",\r\n    text: truncateString(settingLabel, 35) + ' (' + truncateString(settingUrl, 35) + ') at ' + settingPositionDisplay,\r\n    click: function() {\r\n      displayContainer.hide();\r\n      editContainer.show();\r\n    }\r\n  });\r\n\r\n  let displayColor = $( \"<div/>\", {\r\n    \"class\": \"col-1 pr-2 display-color\",\r\n    html: '<div style=\"background-color: ' + settingColor + ';\"></div>',\r\n    click: function() {\r\n      displayContainer.hide();\r\n      editContainer.show();\r\n    }\r\n  });\r\n\r\n  let deleteBtnContainer = $( \"<div/>\", {\r\n    \"class\": \"col-1 display-delete\"\r\n  });\r\n\r\n  let deleteBtn = $( \"<button/>\", {\r\n    \"class\": \"btn btn-danger btn-sm delete\",\r\n    html: '<i class=\"fas fa-trash fa-lg\"></i>',\r\n    click: function() {\r\n      $(this).parent().parent().parent().remove();\r\n      browser.storage.local.remove(settingUrl);\r\n      showOrHideEmptyNotice();\r\n    }\r\n  });\r\n\r\n  let editContainer = $( \"<div/>\", {\r\n    \"class\": \"row no-gutters mb-2 edit-container\",\r\n    \"style\": \"display: none;\"\r\n  });\r\n\r\n  let editUrlInputContainer = $( \"<div/>\", {\r\n    \"class\": \"col-10 pr-1 mb-2 edit-url-container\"\r\n  });\r\n\r\n  let editUrlInput = $( \"<input/>\", {\r\n    \"class\": \"form-control edit-url\",\r\n    value: settingUrl\r\n  });\r\n\r\n  let editColorInputContainer = $( \"<div/>\", {\r\n    \"class\": \"col-1 pr-1 mb-2 edit-color\"\r\n  });\r\n\r\n  let editColorInput = $( \"<input/>\", {\r\n    \"class\": \"color-picker\",\r\n    value: settingColor\r\n  });\r\n\r\n  let updateBtnContainer = $( \"<div/>\", {\r\n    \"class\": \"col-1 mb-2 edit-delete\"\r\n  });\r\n\r\n  let updateBtn = $( \"<button/>\", {\r\n    \"class\": \"btn btn-success btn-sm update\",\r\n    html: '<i class=\"fas fa-pencil-alt fa-lg\"></i>',\r\n    click: function() {\r\n      let urlEditVal = editUrlInput.val();\r\n      let colorEditVal = editColorInput.val();\r\n      let labelEditVal = editLabelInput.val();\r\n      let positionEditVal = optionsSelect.val();\r\n\r\n      if (urlEditVal !== settingUrl || colorEditVal !== settingColor || labelEditVal !== settingLabel || positionEditVal !== settingPosition) {\r\n        updateSetting(settingUrl, urlEditVal, colorEditVal, labelEditVal, positionEditVal);\r\n        innerSettingsContainer.remove();\r\n      }\r\n    }\r\n  });\r\n\r\n  let editLabelInputContainer = $( \"<div/>\", {\r\n    \"class\": \"col-6 pr-2 edit-label-container\"\r\n  });\r\n\r\n  let editLabelInput = $( \"<input/>\", {\r\n    \"class\": \"form-control edit-label\",\r\n    value: settingLabel\r\n  });\r\n\r\n  let optionsSelectContainer = $( \"<div/>\", {\r\n    \"class\": \"col-5 pr-2 edit-position-container\"\r\n  });\r\n\r\n  let optionsSelect = $( \"<select/>\", {\r\n    \"class\": \"form-control edit-position\"\r\n  });\r\n\r\n  for (let i = 0; i < positionsMap.length; i++) {\r\n    if (positionsMap[i].value === settingPosition) {\r\n      optionsSelect.append(new Option(positionsMap[i].label, positionsMap[i].value, true, true));\r\n    } else {\r\n      optionsSelect.append(new Option(positionsMap[i].label, positionsMap[i].value));\r\n    }\r\n  }\r\n\r\n  let cancelBtnContainer = $( \"<div/>\", {\r\n    \"class\": \"col-1 edit-cancel\"\r\n  });\r\n\r\n  let cancelBtn = $( \"<button/>\", {\r\n    \"class\": \"btn btn-secondary btn-sm cancel\",\r\n    html: '<i class=\"fas fa-times fa-lg\"></i>',\r\n    click: function() {\r\n      displayContainer.show();\r\n      editContainer.hide();\r\n      editUrlInput.val(settingUrl);\r\n      editColorInput.val(settingColor);\r\n      editLabelInput.val(settingLabel);\r\n      optionsSelect.val(settingPosition);\r\n    }\r\n  });\r\n\r\n  editUrlInputContainer.append(editUrlInput);\r\n  editColorInputContainer.append(editColorInput);\r\n  optionsSelectContainer.append(optionsSelect);\r\n  updateBtnContainer.append(updateBtn);\r\n  editLabelInputContainer.append(editLabelInput);\r\n  cancelBtnContainer.append(cancelBtn);\r\n\r\n  editContainer.append(editUrlInputContainer);\r\n  editContainer.append(editColorInputContainer);\r\n  editContainer.append(updateBtnContainer);\r\n  editContainer.append(editLabelInputContainer);\r\n  editContainer.append(optionsSelectContainer);\r\n  editContainer.append(cancelBtnContainer);\r\n\r\n  deleteBtnContainer.append(deleteBtn);\r\n\r\n  displayContainer.append(displayLabelUrl);\r\n  displayContainer.append(displayColor);\r\n  displayContainer.append(deleteBtnContainer);\r\n\r\n  innerSettingsContainer.append(displayContainer);\r\n  innerSettingsContainer.append(editContainer);\r\n\r\n  $('.settings-container').append(innerSettingsContainer);\r\n\r\n  let pickr = Pickr.create({\r\n    el: editColorInput[0],\r\n    theme: 'nano',\r\n    default: settingColor,\r\n    useAsButton: false,\r\n    swatches: [\r\n      'rgba(244, 67,  54, 1)',\r\n      'rgba(233, 30,  99, 1)',\r\n      'rgba(156, 39, 176, 1)',\r\n      'rgba(103, 58, 183, 1)',\r\n      'rgba(63,  81, 181, 1)',\r\n      'rgba(33, 150, 243, 1)',\r\n      'rgba(3,  169, 244, 1)'\r\n    ],\r\n    components: {\r\n      preview: true,\r\n      opacity: false,\r\n      hue: true,\r\n      interaction: {\r\n        hex: false,\r\n        rgba: false,\r\n        hsla: false,\r\n        hsva: false,\r\n        cmyk: false,\r\n        input: true,\r\n        clear: false,\r\n        save: true\r\n      }\r\n    }\r\n  });\r\n\r\n  pickr.on('save', (color, instance) => {\r\n    editColorInput.val(color.toHEXA().toString(0));\r\n    instance.hide();\r\n  });\r\n}\r\n\r\n/* Update settings */\r\nfunction updateSetting(settingUrl, newSettingUrl, settingColor, settingLabel, settingPosition) {\r\n  browser.storage.local.set({ [newSettingUrl] : [settingColor, settingLabel, settingPosition] }).then(() => {\r\n    if (settingUrl !== newSettingUrl) {\r\n      // Changed URL\r\n      browser.storage.local.remove(settingUrl).then(() => {\r\n        displaySetting(newSettingUrl, settingColor, settingLabel, settingPosition);\r\n      }, onError);\r\n    } else {\r\n      // Change settings\r\n      displaySetting(newSettingUrl, settingColor, settingLabel, settingPosition);\r\n    }\r\n  }, onError);\r\n}\r\n\r\n/* Clear all settings from the display and storage */\r\nfunction clearAll() {\r\n  $('.settings-container .setting').each((index, element) => {\r\n    element.remove();\r\n  });\r\n  browser.storage.local.clear();\r\n  showOrHideEmptyNotice(show);\r\n}\r\n\r\n$(document).ready(() => {\r\n  /* Display previously saved markers on startup */\r\n  initialize();\r\n\r\n  $('.save').click(() => {\r\n    saveSettings();\r\n  });\r\n\r\n  $('.clear').click(() => {\r\n    clearAll();\r\n  });\r\n\r\n  $('.import-export').click(() => {\r\n    browser.runtime.openOptionsPage();\r\n  });\r\n\r\n  $(document).keydown(function(event) {\r\n    // Enter\r\n    if (event.key === 'Enter' || event.key === 'NumpadEnter') {\r\n      saveSettings();\r\n    }\r\n\r\n    // Escape\r\n    if (event.key === 'Escape') {\r\n      window.close();\r\n    } else {\r\n      return true;\r\n    }\r\n  });\r\n\r\n  pickr = Pickr.create({\r\n    el: '.color-picker',\r\n    theme: 'nano',\r\n    useAsButton: false,\r\n    swatches: [\r\n      'rgba(244, 67,  54, 1)',\r\n      'rgba(233, 30,  99, 1)',\r\n      'rgba(156, 39, 176, 1)',\r\n      'rgba(103, 58, 183, 1)',\r\n      'rgba(63,  81, 181, 1)',\r\n      'rgba(33, 150, 243, 1)',\r\n      'rgba(3,  169, 244, 1)'\r\n    ],\r\n    components: {\r\n      preview: true,\r\n      opacity: false,\r\n      hue: true,\r\n      interaction: {\r\n        hex: false,\r\n        rgba: false,\r\n        hsla: false,\r\n        hsva: false,\r\n        cmyk: false,\r\n        input: true,\r\n        clear: false,\r\n        save: true\r\n      }\r\n    }\r\n  });\r\n\r\n  pickr.on('save', (color, instance) => {\r\n    //$('.settings-input #color').val(color.toHEXA().toString(0));\r\n    instance.hide();\r\n  });\r\n});\r\n"]}