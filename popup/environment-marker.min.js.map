{"version":3,"sources":["environment-marker.js"],"names":["positionInputTopLeft","browser","i18n","getMessage","positionInputTopRight","positionInputBottomLeft","positionInputBottomRight","noticeNoRibbons","buttonClearAll","buttonImportExport","errorDuplicateMarker","errorLabelEmpty","errorUrlEmpty","pickr","hide","show","positionsMap","value","label","onError","error","console","log","truncateString","str","num","length","slice","initialize","storage","local","get","then","results","settingsUrls","Object","keys","showOrHideEmptyNotice","settingUrl","displaySetting","action","$","css","showMessage","textMsg","errorFlag","messageClass","remove","append","saveSettings","val","settingColor","getSelectedColor","toHEXA","toString","settingLabel","settingPosition","result","storeSetting","set","[object Object]","settingPositionDisplay","reduce","accumulator","currentValue","innerSettingsContainer","class","displayContainer","displayLabelUrl","text","click","editContainer","displayColor","html","deleteBtnContainer","deleteBtn","this","parent","style","editUrlInputContainer","editUrlInput","editColorInputContainer","editColorInput","updateBtnContainer","updateBtn","urlEditVal","colorEditVal","labelEditVal","editLabelInput","positionEditVal","optionsSelect","updateSetting","editLabelInputContainer","optionsSelectContainer","i","Option","cancelBtnContainer","cancelBtn","Pickr","create","el","theme","default","useAsButton","swatches","components","preview","opacity","hue","interaction","hex","rgba","hsla","hsva","cmyk","input","clear","save","on","color","instance","newSettingUrl","clearAll","each","index","element","document","ready","runtime","openOptionsPage","keydown","event","key","window","close"],"mappings":"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","file":"environment-marker.min.js","sourcesContent":["let positionInputTopLeft = browser.i18n.getMessage(\"positionInputTopLeft\");\r\nlet positionInputTopRight = browser.i18n.getMessage(\"positionInputTopRight\");\r\nlet positionInputBottomLeft = browser.i18n.getMessage(\"positionInputBottomLeft\");\r\nlet positionInputBottomRight = browser.i18n.getMessage(\"positionInputBottomRight\");\r\nlet noticeNoRibbons = browser.i18n.getMessage(\"noticeNoRibbons\");\r\nlet buttonClearAll = browser.i18n.getMessage(\"buttonClearAll\");\r\nlet buttonImportExport = browser.i18n.getMessage(\"buttonImportExport\");\r\nlet errorDuplicateMarker = browser.i18n.getMessage(\"errorDuplicateMarker\");\r\nlet errorLabelEmpty = browser.i18n.getMessage(\"errorLabelEmpty\");\r\nlet errorUrlEmpty = browser.i18n.getMessage(\"errorUrlEmpty\");\r\nlet pickr = null;\r\nconst hide = 'none';\r\nconst show = 'block';\r\nconst positionsMap = [\r\n  {value: 'top-left', label: positionInputTopLeft},\r\n  {value: 'top-right', label: positionInputTopRight},\r\n  {value: 'bottom-left', label: positionInputBottomLeft},\r\n  {value: 'bottom-right', label: positionInputBottomRight}\r\n];\r\n\r\nfunction onError(error) {\r\n  console.log(error);\r\n}\r\n\r\nfunction truncateString(str, num) {\r\n  if (str.length <= num) {\r\n    return str\r\n  }\r\n  return str.slice(0, num) + '...'\r\n}\r\n\r\nfunction initialize() {\r\n  browser.storage.local.get(null).then((results) => {\r\n    let settingsUrls = Object.keys(results);\r\n    settingsUrls.length > 0 ? showOrHideEmptyNotice(hide) : showOrHideEmptyNotice(show);\r\n    for (let settingUrl of settingsUrls) {\r\n      displaySetting(settingUrl, results[settingUrl][0], results[settingUrl][1], results[settingUrl][2]);\r\n    }\r\n  }, onError);\r\n}\r\n\r\nfunction showOrHideEmptyNotice(action = null) {\r\n  if (action !== show && action !== hide) {\r\n    browser.storage.local.get(null).then((results) => {\r\n      let settingsUrls = Object.keys(results);\r\n      $('.empty-notice').css('display', settingsUrls.length > 0 ? 'none' : 'block');\r\n    }, onError);\r\n  } else {\r\n    $('.empty-notice').css('display', action);\r\n  }\r\n}\r\n\r\n/* Show error message */\r\nfunction showMessage(textMsg, errorFlag = false) {\r\n  let messageClass = errorFlag ? 'alert-danger' : 'alert-success';\r\n  if ($('.outer-wrapper .message-container .alert').length) {\r\n    $('.outer-wrapper .message-container .alert').remove();\r\n    $('.outer-wrapper .message-container').append('<div class=\"alert ' + messageClass + ' col-12\">' + textMsg + '</div>');\r\n  } else {\r\n    $('.outer-wrapper .message-container').append('<div class=\"alert ' + messageClass + ' col-12\">' + textMsg + '</div>');\r\n  }\r\n}\r\n\r\n/* Add a setting to the display and storage */\r\nfunction saveSettings() {\r\n  let settingUrl = $('.settings-input #url').val(),\r\n      settingColor = pickr.getSelectedColor().toHEXA().toString(0),\r\n      settingLabel = $('.settings-input #label').val(),\r\n      settingPosition = $('.settings-input #position').val();\r\n\r\n  if (settingUrl !== '' && settingColor !== '' && settingLabel !== '') {\r\n    browser.storage.local.get(settingUrl).then((result) => {\r\n      let objTest = Object.keys(result);\r\n\r\n      if (objTest.length < 1) {\r\n        if ($('.outer-wrapper .message-container .alert').length) {\r\n          $('.outer-wrapper .message-container .alert').remove();\r\n        }\r\n\r\n        $('.settings-input #url').val('');\r\n        $('.settings-input #label').val('');\r\n        $('.settings-input #position').val('top-left');\r\n\r\n        storeSetting(settingUrl, settingColor, settingLabel, settingPosition);\r\n      } else {\r\n        // Duplicate marker error message\r\n        showMessage(errorDuplicateMarker);\r\n      }\r\n    }, onError);\r\n  } else {\r\n    // Empty input error message\r\n    settingLabel === '' ? showMessage(errorLabelEmpty) : showMessage(errorUrlEmpty);\r\n  }\r\n}\r\n\r\n/* Store a new setting in local storage */\r\nfunction storeSetting(settingUrl, settingColor, settingLabel, settingPosition) {\r\n  browser.storage.local.set({ [settingUrl] : [settingColor, settingLabel, settingPosition] }).then(() => {\r\n    showOrHideEmptyNotice(hide);\r\n    displaySetting(settingUrl, settingColor, settingLabel, settingPosition);\r\n  }, onError);\r\n}\r\n\r\n/* Display a setting in the setting box */\r\nfunction displaySetting(settingUrl, settingColor, settingLabel, settingPosition) {\r\n  let settingPositionDisplay = positionsMap.reduce(function(accumulator, currentValue) {\r\n    if (currentValue.value == settingPosition) {\r\n      accumulator = currentValue.label;\r\n    }\r\n    return accumulator;\r\n  }, {});\r\n\r\n  let innerSettingsContainer = $( \"<div/>\", { \"class\": \"setting\" });\r\n  let displayContainer = $( \"<div/>\", { \"class\": \"row no-gutters mb-2 display-container\" });\r\n\r\n  let displayLabelUrl = $( \"<div/>\", {\r\n    \"class\": \"col-10 pr-2 display-labelUrl\",\r\n    text: truncateString(settingLabel, 35) + ' (' + truncateString(settingUrl, 35) + ') at ' + settingPositionDisplay,\r\n    click: function() {\r\n      displayContainer.hide();\r\n      editContainer.show();\r\n    }\r\n  });\r\n\r\n  let displayColor = $( \"<div/>\", {\r\n    \"class\": \"col-1 pr-2 display-color\",\r\n    html: '<div style=\"background-color: ' + settingColor + ';\"></div>',\r\n    click: function() {\r\n      displayContainer.hide();\r\n      editContainer.show();\r\n    }\r\n  });\r\n\r\n  let deleteBtnContainer = $( \"<div/>\", {\r\n    \"class\": \"col-1 display-delete\"\r\n  });\r\n\r\n  let deleteBtn = $( \"<button/>\", {\r\n    \"class\": \"btn btn-danger btn-sm delete\",\r\n    html: '<i class=\"fas fa-trash fa-lg\"></i>',\r\n    click: function() {\r\n      $(this).parent().parent().parent().remove();\r\n      browser.storage.local.remove(settingUrl);\r\n      showOrHideEmptyNotice();\r\n    }\r\n  });\r\n\r\n  let editContainer = $( \"<div/>\", {\r\n    \"class\": \"row no-gutters mb-2 edit-container\",\r\n    \"style\": \"display: none;\"\r\n  });\r\n\r\n  let editUrlInputContainer = $( \"<div/>\", {\r\n    \"class\": \"col-10 pr-1 mb-2 edit-url-container\"\r\n  });\r\n\r\n  let editUrlInput = $( \"<input/>\", {\r\n    \"class\": \"form-control edit-url\",\r\n    value: settingUrl\r\n  });\r\n\r\n  let editColorInputContainer = $( \"<div/>\", {\r\n    \"class\": \"col-1 pr-1 mb-2 edit-color\"\r\n  });\r\n\r\n  let editColorInput = $( \"<input/>\", {\r\n    \"class\": \"color-picker\",\r\n    value: settingColor\r\n  });\r\n\r\n  let updateBtnContainer = $( \"<div/>\", {\r\n    \"class\": \"col-1 mb-2 edit-delete\"\r\n  });\r\n\r\n  let updateBtn = $( \"<button/>\", {\r\n    \"class\": \"btn btn-success btn-sm update\",\r\n    html: '<i class=\"fas fa-pencil-alt fa-lg\"></i>',\r\n    click: function() {\r\n      let urlEditVal = editUrlInput.val();\r\n      let colorEditVal = editColorInput.val();\r\n      let labelEditVal = editLabelInput.val();\r\n      let positionEditVal = optionsSelect.val();\r\n\r\n      if (urlEditVal !== settingUrl || colorEditVal !== settingColor || labelEditVal !== settingLabel || positionEditVal !== settingPosition) {\r\n        updateSetting(settingUrl, urlEditVal, colorEditVal, labelEditVal, positionEditVal);\r\n        innerSettingsContainer.remove();\r\n      }\r\n    }\r\n  });\r\n\r\n  let editLabelInputContainer = $( \"<div/>\", {\r\n    \"class\": \"col-6 pr-2 edit-label-container\"\r\n  });\r\n\r\n  let editLabelInput = $( \"<input/>\", {\r\n    \"class\": \"form-control edit-label\",\r\n    value: settingLabel\r\n  });\r\n\r\n  let optionsSelectContainer = $( \"<div/>\", {\r\n    \"class\": \"col-5 pr-2 edit-position-container\"\r\n  });\r\n\r\n  let optionsSelect = $( \"<select/>\", {\r\n    \"class\": \"form-control edit-position\"\r\n  });\r\n\r\n  for (let i = 0; i < positionsMap.length; i++) {\r\n    if (positionsMap[i].value === settingPosition) {\r\n      optionsSelect.append(new Option(positionsMap[i].label, positionsMap[i].value, true, true));\r\n    } else {\r\n      optionsSelect.append(new Option(positionsMap[i].label, positionsMap[i].value));\r\n    }\r\n  }\r\n\r\n  let cancelBtnContainer = $( \"<div/>\", {\r\n    \"class\": \"col-1 edit-cancel\"\r\n  });\r\n\r\n  let cancelBtn = $( \"<button/>\", {\r\n    \"class\": \"btn btn-secondary btn-sm cancel\",\r\n    html: '<i class=\"fas fa-times fa-lg\"></i>',\r\n    click: function() {\r\n      displayContainer.show();\r\n      editContainer.hide();\r\n      editUrlInput.val(settingUrl);\r\n      editColorInput.val(settingColor);\r\n      editLabelInput.val(settingLabel);\r\n      optionsSelect.val(settingPosition);\r\n    }\r\n  });\r\n\r\n  editUrlInputContainer.append(editUrlInput);\r\n  editColorInputContainer.append(editColorInput);\r\n  optionsSelectContainer.append(optionsSelect);\r\n  updateBtnContainer.append(updateBtn);\r\n  editLabelInputContainer.append(editLabelInput);\r\n  cancelBtnContainer.append(cancelBtn);\r\n\r\n  editContainer.append(editUrlInputContainer);\r\n  editContainer.append(editColorInputContainer);\r\n  editContainer.append(updateBtnContainer);\r\n  editContainer.append(editLabelInputContainer);\r\n  editContainer.append(optionsSelectContainer);\r\n  editContainer.append(cancelBtnContainer);\r\n\r\n  deleteBtnContainer.append(deleteBtn);\r\n\r\n  displayContainer.append(displayLabelUrl);\r\n  displayContainer.append(displayColor);\r\n  displayContainer.append(deleteBtnContainer);\r\n\r\n  innerSettingsContainer.append(displayContainer);\r\n  innerSettingsContainer.append(editContainer);\r\n\r\n  $('.settings-container').append(innerSettingsContainer);\r\n\r\n  let pickr = Pickr.create({\r\n    el: editColorInput[0],\r\n    theme: 'nano',\r\n    default: settingColor,\r\n    useAsButton: false,\r\n    swatches: [\r\n      'rgba(244, 67,  54, 1)',\r\n      'rgba(233, 30,  99, 1)',\r\n      'rgba(156, 39, 176, 1)',\r\n      'rgba(103, 58, 183, 1)',\r\n      'rgba(63,  81, 181, 1)',\r\n      'rgba(33, 150, 243, 1)',\r\n      'rgba(3,  169, 244, 1)'\r\n    ],\r\n    components: {\r\n      preview: true,\r\n      opacity: false,\r\n      hue: true,\r\n      interaction: {\r\n        hex: false,\r\n        rgba: false,\r\n        hsla: false,\r\n        hsva: false,\r\n        cmyk: false,\r\n        input: true,\r\n        clear: false,\r\n        save: true\r\n      }\r\n    }\r\n  });\r\n\r\n  pickr.on('save', (color, instance) => {\r\n    editColorInput.val(color.toHEXA().toString(0));\r\n    instance.hide();\r\n  });\r\n}\r\n\r\n/* Update settings */\r\nfunction updateSetting(settingUrl, newSettingUrl, settingColor, settingLabel, settingPosition) {\r\n  browser.storage.local.set({ [newSettingUrl] : [settingColor, settingLabel, settingPosition] }).then(() => {\r\n    if (settingUrl !== newSettingUrl) {\r\n      // Changed URL\r\n      browser.storage.local.remove(settingUrl).then(() => {\r\n        displaySetting(newSettingUrl, settingColor, settingLabel, settingPosition);\r\n      }, onError);\r\n    } else {\r\n      // Change settings\r\n      displaySetting(newSettingUrl, settingColor, settingLabel, settingPosition);\r\n    }\r\n  }, onError);\r\n}\r\n\r\n/* Clear all settings from the display and storage */\r\nfunction clearAll() {\r\n  $('.settings-container .setting').each((index, element) => {\r\n    element.remove();\r\n  });\r\n  browser.storage.local.clear();\r\n  showOrHideEmptyNotice(show);\r\n}\r\n\r\n$(document).ready(() => {\r\n  /* Display previously saved markers on startup */\r\n  initialize();\r\n\r\n  $('.save').click(() => {\r\n    saveSettings();\r\n  });\r\n\r\n  $('.clear').click(() => {\r\n    clearAll();\r\n  });\r\n\r\n  $('.import-export').click(() => {\r\n    browser.runtime.openOptionsPage();\r\n  });\r\n\r\n  $(document).keydown(function(event) {\r\n    // Enter\r\n    if (event.key === 'Enter' || event.key === 'NumpadEnter') {\r\n      saveSettings();\r\n    }\r\n\r\n    // Escape\r\n    if (event.key === 'Escape') {\r\n      window.close();\r\n    } else {\r\n      return true;\r\n    }\r\n  });\r\n\r\n  pickr = Pickr.create({\r\n    el: '.color-picker',\r\n    theme: 'nano',\r\n    useAsButton: false,\r\n    swatches: [\r\n      'rgba(244, 67,  54, 1)',\r\n      'rgba(233, 30,  99, 1)',\r\n      'rgba(156, 39, 176, 1)',\r\n      'rgba(103, 58, 183, 1)',\r\n      'rgba(63,  81, 181, 1)',\r\n      'rgba(33, 150, 243, 1)',\r\n      'rgba(3,  169, 244, 1)'\r\n    ],\r\n    components: {\r\n      preview: true,\r\n      opacity: false,\r\n      hue: true,\r\n      interaction: {\r\n        hex: false,\r\n        rgba: false,\r\n        hsla: false,\r\n        hsva: false,\r\n        cmyk: false,\r\n        input: true,\r\n        clear: false,\r\n        save: true\r\n      }\r\n    }\r\n  });\r\n\r\n  pickr.on('save', (color, instance) => {\r\n    //$('.settings-input #color').val(color.toHEXA().toString(0));\r\n    instance.hide();\r\n  });\r\n\r\n  $('span.empty-notice').html(noticeNoRibbons);\r\n  $('button.clear').html(buttonClearAll);\r\n  $('button.import-export').html(buttonImportExport);\r\n\r\n  $('select#position option[value=\"top-left\"]').html(positionInputTopLeft);\r\n  $('select#position option[value=\"top-right\"]').html(positionInputTopRight);\r\n  $('select#position option[value=\"bottom-left\"]').html(positionInputBottomLeft);\r\n  $('select#position option[value=\"bottom-right\"]').html(positionInputBottomRight);\r\n});\r\n"]}