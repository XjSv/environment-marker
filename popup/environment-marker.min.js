const hide="none",show="block",positionsMap=[{value:"top-left",label:"Top Left"},{value:"top-right",label:"Top Right"},{value:"bottom-left",label:"Bottom Left"},{value:"bottom-right",label:"Bottom Right"}];let exportFile=null,pickr=null;function onError(e){console.log(e)}function truncateString(e,t){return e.length<=t?e:e.slice(0,t)+"..."}function initialize(){browser.storage.local.get(null).then(e=>{let t=Object.keys(e);t.length>0?showOrHideEmptyNotice(hide):showOrHideEmptyNotice(show);for(let o of t)displaySetting(o,e[o][0],e[o][1],e[o][2])},onError)}function showOrHideEmptyNotice(e=null){e!==show&&e!==hide?browser.storage.local.get(null).then(e=>{let t=Object.keys(e);$(".empty-notice").css("display",t.length>0?"none":"block")},onError):$(".empty-notice").css("display",e)}function showErrorMessage(e){$(".outer-wrapper .message-container .error").length?($(".outer-wrapper .message-container .error").remove(),$(".outer-wrapper .message-container").append('<div class="error col-12">'+e+"</div>")):$(".outer-wrapper .message-container").append('<div class="error col-12">'+e+"</div>")}function saveSettings(e,t,o,n,r=!1){let i=r?e:$(".settings-input #url").val(),a=r?t:pickr.getSelectedColor().toHEXA().toString(0),l=r?o:$(".settings-input #label").val(),s=r?n:$(".settings-input #position").val();""!==i&&""!==a&&""!==l?browser.storage.local.get(i).then(e=>{Object.keys(e).length<1?($(".outer-wrapper .message-container .error").length&&$(".outer-wrapper .message-container .error").remove(),$(".settings-input #url").val(""),$(".settings-input #label").val(""),$(".settings-input #position").val("top-left"),storeSetting(i,a,l,s)):showErrorMessage("Marker for this URL already exists!")},onError):showErrorMessage(""===l?"Enter Label !":"Enter URL !")}function storeSetting(e,t,o,n){browser.storage.local.set({[e]:[t,o,n]}).then(()=>{showOrHideEmptyNotice(hide),displaySetting(e,t,o,n)},onError)}function displaySetting(e,t,o,n){let r=positionsMap.reduce((function(e,t){return t.value==n&&(e=t.label),e}),{}),i=$("<div/>",{class:"setting"}),a=$("<div/>",{class:"row no-gutters mb-2 display-container"}),l=$("<div/>",{class:"col-10 pr-2 display-labelUrl",text:o+" ("+e+") at "+r,click:function(){a.hide(),d.show()}}),s=$("<div/>",{class:"col-1 pr-2 display-color",html:'<div style="background-color: '+t+';"></div>',click:function(){a.hide(),d.show()}}),c=$("<div/>",{class:"col-1 display-delete"}),p=$("<button/>",{class:"btn btn-danger btn-sm delete",html:'<i class="fas fa-trash fa-lg"></i>',click:function(){$(this).parent().parent().parent().remove(),browser.storage.local.remove(e),showOrHideEmptyNotice()}}),d=$("<div/>",{class:"row no-gutters mb-2 edit-container",style:"display: none;"}),u=$("<div/>",{class:"col-10 pr-1 mb-2 edit-url-container"}),g=$("<input/>",{class:"form-control edit-url",value:e}),b=$("<div/>",{class:"col-1 pr-1 mb-2 edit-color"}),h=$("<input/>",{class:"color-picker",value:t}),v=$("<div/>",{class:"col-1 mb-2 edit-delete"}),m=$("<button/>",{class:"btn btn-success btn-sm update",html:'<i class="fas fa-pencil-alt fa-lg"></i>',click:function(){let r=g.val(),a=h.val(),l=w.val(),s=k.val();r===e&&a===t&&l===o&&s===n||(updateSetting(e,r,a,l,s),i.remove())}}),f=$("<div/>",{class:"col-6 pr-2 edit-label-container"}),w=$("<input/>",{class:"form-control edit-label",value:o}),y=$("<div/>",{class:"col-5 pr-2 edit-position-container"}),k=$("<select/>",{class:"form-control edit-position"});for(let e=0;e<positionsMap.length;e++)positionsMap[e].value===n?k.append(new Option(positionsMap[e].label,positionsMap[e].value,!0,!0)):k.append(new Option(positionsMap[e].label,positionsMap[e].value));let E=$("<div/>",{class:"col-1 edit-cancel"}),S=$("<button/>",{class:"btn btn-secondary btn-sm cancel",html:'<i class="fas fa-times fa-lg"></i>',click:function(){a.show(),d.hide(),g.val(e),h.val(t),w.val(o),k.val(n)}});u.append(g),b.append(h),y.append(k),v.append(m),f.append(w),E.append(S),d.append(u),d.append(b),d.append(v),d.append(f),d.append(y),d.append(E),c.append(p),a.append(l),a.append(s),a.append(c),i.append(a),i.append(d),$(".settings-container").append(i),Pickr.create({el:h[0],theme:"nano",default:t,useAsButton:!1,swatches:["rgba(244, 67,  54, 1)","rgba(233, 30,  99, 1)","rgba(156, 39, 176, 1)","rgba(103, 58, 183, 1)","rgba(63,  81, 181, 1)","rgba(33, 150, 243, 1)","rgba(3,  169, 244, 1)"],components:{preview:!0,opacity:!1,hue:!0,interaction:{hex:!1,rgba:!1,hsla:!1,hsva:!1,cmyk:!1,input:!0,clear:!1,save:!0}}}).on("save",(e,t)=>{h.val(e.toHEXA().toString(0)),t.hide()})}function updateSetting(e,t,o,n,r){browser.storage.local.set({[t]:[o,n,r]}).then(()=>{e!==t?browser.storage.local.remove(e).then(()=>{displaySetting(t,o,n,r)},onError):displaySetting(t,o,n,r)},onError)}function clearAll(){$(".settings-container .setting").each((e,t)=>{t.remove()}),browser.storage.local.clear(),showOrHideEmptyNotice(show)}function makeJsonExportFile(e){let t=new Blob([e],{type:"application/json"});return null!==exportFile&&window.URL.revokeObjectURL(exportFile),exportFile=window.URL.createObjectURL(t),exportFile}function exportConfig(){browser.storage.local.get(null).then(e=>{let t=Object.keys(e),o=[];if(t.length>0){for(let n of t)o.push({url:n,color:e[n][0],label:e[n][1],position:e[n][2]});let n=JSON.stringify(o),r=document.createElement("a");r.setAttribute("download","configurations.json"),r.href=makeJsonExportFile(n),document.body.appendChild(r),window.requestAnimationFrame((function(){let e=new MouseEvent("click");r.dispatchEvent(e),document.body.removeChild(r)}))}},onError)}function importConfig(){let e=document.getElementById("importFile"),t=e.files[0];const o=new FileReader;o.addEventListener("load",(function(){let t=JSON.parse(o.result);t.length>0&&t.forEach((function(e){saveSettings(e.url,e.color,e.label,e.position,!0)})),e.value=""})),o.readAsText(t)}$(document).ready(()=>{initialize(),$(".save").click(()=>{saveSettings()}),$(".clear").click(()=>{clearAll()}),$(".import-export").click(()=>{$(".export-import-container").toggle()}),$(".export").click(()=>{exportConfig()}),$(".import").click(()=>{importConfig()}),$(document).keydown((function(e){if("Enter"!==e.key&&"NumpadEnter"!==e.key||saveSettings(),"Escape"!==e.key)return!0;window.close()})),pickr=Pickr.create({el:".color-picker",theme:"nano",useAsButton:!1,swatches:["rgba(244, 67,  54, 1)","rgba(233, 30,  99, 1)","rgba(156, 39, 176, 1)","rgba(103, 58, 183, 1)","rgba(63,  81, 181, 1)","rgba(33, 150, 243, 1)","rgba(3,  169, 244, 1)"],components:{preview:!0,opacity:!1,hue:!0,interaction:{hex:!1,rgba:!1,hsla:!1,hsva:!1,cmyk:!1,input:!0,clear:!1,save:!0}}}),pickr.on("save",(e,t)=>{t.hide()})});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImVudmlyb25tZW50LW1hcmtlci5qcyJdLCJuYW1lcyI6WyJoaWRlIiwic2hvdyIsInBvc2l0aW9uc01hcCIsInZhbHVlIiwibGFiZWwiLCJleHBvcnRGaWxlIiwicGlja3IiLCJvbkVycm9yIiwiZXJyb3IiLCJjb25zb2xlIiwibG9nIiwidHJ1bmNhdGVTdHJpbmciLCJzdHIiLCJudW0iLCJsZW5ndGgiLCJzbGljZSIsImluaXRpYWxpemUiLCJicm93c2VyIiwic3RvcmFnZSIsImxvY2FsIiwiZ2V0IiwidGhlbiIsInJlc3VsdHMiLCJzZXR0aW5nc1VybHMiLCJPYmplY3QiLCJrZXlzIiwic2hvd09ySGlkZUVtcHR5Tm90aWNlIiwic2V0dGluZ1VybCIsImRpc3BsYXlTZXR0aW5nIiwiYWN0aW9uIiwiJCIsImNzcyIsInNob3dFcnJvck1lc3NhZ2UiLCJ0ZXh0TXNnIiwicmVtb3ZlIiwiYXBwZW5kIiwic2F2ZVNldHRpbmdzIiwidXJsSW4iLCJjb2xvckluIiwibGFiZWxJbiIsInBvc2l0aW9uSW4iLCJpbXBvcnRGbGFnIiwidmFsIiwic2V0dGluZ0NvbG9yIiwiZ2V0U2VsZWN0ZWRDb2xvciIsInRvSEVYQSIsInRvU3RyaW5nIiwic2V0dGluZ0xhYmVsIiwic2V0dGluZ1Bvc2l0aW9uIiwicmVzdWx0Iiwic3RvcmVTZXR0aW5nIiwic2V0IiwiW29iamVjdCBPYmplY3RdIiwic2V0dGluZ1Bvc2l0aW9uRGlzcGxheSIsInJlZHVjZSIsImFjY3VtdWxhdG9yIiwiY3VycmVudFZhbHVlIiwiaW5uZXJTZXR0aW5nc0NvbnRhaW5lciIsImNsYXNzIiwiZGlzcGxheUNvbnRhaW5lciIsImRpc3BsYXlMYWJlbFVybCIsInRleHQiLCJjbGljayIsImVkaXRDb250YWluZXIiLCJkaXNwbGF5Q29sb3IiLCJodG1sIiwiZGVsZXRlQnRuQ29udGFpbmVyIiwiZGVsZXRlQnRuIiwidGhpcyIsInBhcmVudCIsInN0eWxlIiwiZWRpdFVybElucHV0Q29udGFpbmVyIiwiZWRpdFVybElucHV0IiwiZWRpdENvbG9ySW5wdXRDb250YWluZXIiLCJlZGl0Q29sb3JJbnB1dCIsInVwZGF0ZUJ0bkNvbnRhaW5lciIsInVwZGF0ZUJ0biIsInVybEVkaXRWYWwiLCJjb2xvckVkaXRWYWwiLCJsYWJlbEVkaXRWYWwiLCJlZGl0TGFiZWxJbnB1dCIsInBvc2l0aW9uRWRpdFZhbCIsIm9wdGlvbnNTZWxlY3QiLCJ1cGRhdGVTZXR0aW5nIiwiZWRpdExhYmVsSW5wdXRDb250YWluZXIiLCJvcHRpb25zU2VsZWN0Q29udGFpbmVyIiwiaSIsIk9wdGlvbiIsImNhbmNlbEJ0bkNvbnRhaW5lciIsImNhbmNlbEJ0biIsIlBpY2tyIiwiY3JlYXRlIiwiZWwiLCJ0aGVtZSIsImRlZmF1bHQiLCJ1c2VBc0J1dHRvbiIsInN3YXRjaGVzIiwiY29tcG9uZW50cyIsInByZXZpZXciLCJvcGFjaXR5IiwiaHVlIiwiaW50ZXJhY3Rpb24iLCJoZXgiLCJyZ2JhIiwiaHNsYSIsImhzdmEiLCJjbXlrIiwiaW5wdXQiLCJjbGVhciIsInNhdmUiLCJvbiIsImNvbG9yIiwiaW5zdGFuY2UiLCJuZXdTZXR0aW5nVXJsIiwiY2xlYXJBbGwiLCJlYWNoIiwiaW5kZXgiLCJlbGVtZW50IiwibWFrZUpzb25FeHBvcnRGaWxlIiwiZGF0YSIsIkJsb2IiLCJ0eXBlIiwid2luZG93IiwiVVJMIiwicmV2b2tlT2JqZWN0VVJMIiwiY3JlYXRlT2JqZWN0VVJMIiwiZXhwb3J0Q29uZmlnIiwiY29uZmlndXJhdGlvbnMiLCJwdXNoIiwidXJsIiwicG9zaXRpb24iLCJjb25maWd1cmF0aW9uc19qc29uIiwiSlNPTiIsInN0cmluZ2lmeSIsImxpbmsiLCJkb2N1bWVudCIsImNyZWF0ZUVsZW1lbnQiLCJzZXRBdHRyaWJ1dGUiLCJocmVmIiwiYm9keSIsImFwcGVuZENoaWxkIiwicmVxdWVzdEFuaW1hdGlvbkZyYW1lIiwiZXZlbnQiLCJNb3VzZUV2ZW50IiwiZGlzcGF0Y2hFdmVudCIsInJlbW92ZUNoaWxkIiwiaW1wb3J0Q29uZmlnIiwiaW1wb3J0RmlsZUlucHV0IiwiZ2V0RWxlbWVudEJ5SWQiLCJpbXBvcnRGaWxlIiwiZmlsZXMiLCJyZWFkZXIiLCJGaWxlUmVhZGVyIiwiYWRkRXZlbnRMaXN0ZW5lciIsImltcG9ydF9jb25maWdfb2JqIiwicGFyc2UiLCJmb3JFYWNoIiwiYXJyYXlJdGVtIiwicmVhZEFzVGV4dCIsInJlYWR5IiwidG9nZ2xlIiwia2V5ZG93biIsImtleSIsImNsb3NlIl0sIm1hcHBpbmdzIjoiQUFDQSxNQUFNQSxLQUFPLE9BQ1BDLEtBQU8sUUFDUEMsYUFBZSxDQUNuQixDQUFDQyxNQUFPLFdBQVlDLE1BQU8sWUFDM0IsQ0FBQ0QsTUFBTyxZQUFhQyxNQUFPLGFBQzVCLENBQUNELE1BQU8sY0FBZUMsTUFBTyxlQUM5QixDQUFDRCxNQUFPLGVBQWdCQyxNQUFPLGlCQUVqQyxJQUFJQyxXQUFhLEtBQ2JDLE1BQVEsS0FHWixTQUFTQyxRQUFRQyxHQUNmQyxRQUFRQyxJQUFJRixHQUdkLFNBQVNHLGVBQWVDLEVBQUtDLEdBQzNCLE9BQUlELEVBQUlFLFFBQVVELEVBQ1RELEVBRUZBLEVBQUlHLE1BQU0sRUFBR0YsR0FBTyxNQUc3QixTQUFTRyxhQUNQQyxRQUFRQyxRQUFRQyxNQUFNQyxJQUFJLE1BQU1DLEtBQU1DLElBQ3BDLElBQUlDLEVBQWVDLE9BQU9DLEtBQUtILEdBQy9CQyxFQUFhVCxPQUFTLEVBQUlZLHNCQUFzQjFCLE1BQVEwQixzQkFBc0J6QixNQUM5RSxJQUFLLElBQUkwQixLQUFjSixFQUNyQkssZUFBZUQsRUFBWUwsRUFBUUssR0FBWSxHQUFJTCxFQUFRSyxHQUFZLEdBQUlMLEVBQVFLLEdBQVksS0FFaEdwQixTQUdMLFNBQVNtQixzQkFBc0JHLEVBQVMsTUFDbENBLElBQVc1QixNQUFRNEIsSUFBVzdCLEtBQ2hDaUIsUUFBUUMsUUFBUUMsTUFBTUMsSUFBSSxNQUFNQyxLQUFNQyxJQUNwQyxJQUFJQyxFQUFlQyxPQUFPQyxLQUFLSCxHQUMvQlEsRUFBRSxpQkFBaUJDLElBQUksVUFBV1IsRUFBYVQsT0FBUyxFQUFJLE9BQVMsVUFDcEVQLFNBRUh1QixFQUFFLGlCQUFpQkMsSUFBSSxVQUFXRixHQUt0QyxTQUFTRyxpQkFBaUJDLEdBQ3BCSCxFQUFFLDRDQUE0Q2hCLFFBQ2hEZ0IsRUFBRSw0Q0FBNENJLFNBQzlDSixFQUFFLHFDQUFxQ0ssT0FBTyw2QkFBNkJGLEVBQVEsV0FFbkZILEVBQUUscUNBQXFDSyxPQUFPLDZCQUE2QkYsRUFBUSxVQUt2RixTQUFTRyxhQUFhQyxFQUFPQyxFQUFTQyxFQUFTQyxFQUFZQyxHQUFhLEdBQ3RFLElBQUlkLEVBQWFjLEVBQWFKLEVBQVFQLEVBQUUsd0JBQXdCWSxNQUM1REMsRUFBZUYsRUFBYUgsRUFBVWhDLE1BQU1zQyxtQkFBbUJDLFNBQVNDLFNBQVMsR0FDakZDLEVBQWVOLEVBQWFGLEVBQVVULEVBQUUsMEJBQTBCWSxNQUNsRU0sRUFBbUJQLEVBQWFELEVBQWFWLEVBQUUsNkJBQTZCWSxNQUU3RCxLQUFmZixHQUFzQyxLQUFqQmdCLEdBQXdDLEtBQWpCSSxFQUM5QzlCLFFBQVFDLFFBQVFDLE1BQU1DLElBQUlPLEdBQVlOLEtBQU00QixJQUM1QnpCLE9BQU9DLEtBQUt3QixHQUVkbkMsT0FBUyxHQUNmZ0IsRUFBRSw0Q0FBNENoQixRQUNoRGdCLEVBQUUsNENBQTRDSSxTQUdoREosRUFBRSx3QkFBd0JZLElBQUksSUFDOUJaLEVBQUUsMEJBQTBCWSxJQUFJLElBQ2hDWixFQUFFLDZCQUE2QlksSUFBSSxZQUVuQ1EsYUFBYXZCLEVBQVlnQixFQUFjSSxFQUFjQyxJQUdyRGhCLGlCQUFpQix3Q0FFbEJ6QixTQUdtQnlCLGlCQUFMLEtBQWpCZSxFQUF1QyxnQkFBb0MsZUFLL0UsU0FBU0csYUFBYXZCLEVBQVlnQixFQUFjSSxFQUFjQyxHQUM1RC9CLFFBQVFDLFFBQVFDLE1BQU1nQyxJQUFJLENBQUVDLENBQUN6QixHQUFjLENBQUNnQixFQUFjSSxFQUFjQyxLQUFvQjNCLEtBQUssS0FDL0ZLLHNCQUFzQjFCLE1BQ3RCNEIsZUFBZUQsRUFBWWdCLEVBQWNJLEVBQWNDLElBQ3REekMsU0FJTCxTQUFTcUIsZUFBZUQsRUFBWWdCLEVBQWNJLEVBQWNDLEdBQzlELElBQUlLLEVBQXlCbkQsYUFBYW9ELFFBQU8sU0FBU0MsRUFBYUMsR0FJckUsT0FISUEsRUFBYXJELE9BQVM2QyxJQUN4Qk8sRUFBY0MsRUFBYXBELE9BRXRCbUQsSUFDTixJQUVDRSxFQUF5QjNCLEVBQUcsU0FBVSxDQUFFNEIsTUFBUyxZQUNqREMsRUFBbUI3QixFQUFHLFNBQVUsQ0FBRTRCLE1BQVMsMENBRTNDRSxFQUFrQjlCLEVBQUcsU0FBVSxDQUNqQzRCLE1BQVMsK0JBQ1RHLEtBQU1kLEVBQWUsS0FBT3BCLEVBQWEsUUFBVTBCLEVBQ25EUyxNQUFPLFdBQ0xILEVBQWlCM0QsT0FDakIrRCxFQUFjOUQsVUFJZCtELEVBQWVsQyxFQUFHLFNBQVUsQ0FDOUI0QixNQUFTLDJCQUNUTyxLQUFNLGlDQUFtQ3RCLEVBQWUsWUFDeERtQixNQUFPLFdBQ0xILEVBQWlCM0QsT0FDakIrRCxFQUFjOUQsVUFJZGlFLEVBQXFCcEMsRUFBRyxTQUFVLENBQ3BDNEIsTUFBUyx5QkFHUFMsRUFBWXJDLEVBQUcsWUFBYSxDQUM5QjRCLE1BQVMsK0JBQ1RPLEtBQU0scUNBQ05ILE1BQU8sV0FDTGhDLEVBQUVzQyxNQUFNQyxTQUFTQSxTQUFTQSxTQUFTbkMsU0FDbkNqQixRQUFRQyxRQUFRQyxNQUFNZSxPQUFPUCxHQUM3QkQsMkJBSUFxQyxFQUFnQmpDLEVBQUcsU0FBVSxDQUMvQjRCLE1BQVMscUNBQ1RZLE1BQVMsbUJBR1BDLEVBQXdCekMsRUFBRyxTQUFVLENBQ3ZDNEIsTUFBUyx3Q0FHUGMsRUFBZTFDLEVBQUcsV0FBWSxDQUNoQzRCLE1BQVMsd0JBQ1R2RCxNQUFPd0IsSUFHTDhDLEVBQTBCM0MsRUFBRyxTQUFVLENBQ3pDNEIsTUFBUywrQkFHUGdCLEVBQWlCNUMsRUFBRyxXQUFZLENBQ2xDNEIsTUFBUyxlQUNUdkQsTUFBT3dDLElBR0xnQyxFQUFxQjdDLEVBQUcsU0FBVSxDQUNwQzRCLE1BQVMsMkJBR1BrQixFQUFZOUMsRUFBRyxZQUFhLENBQzlCNEIsTUFBUyxnQ0FDVE8sS0FBTSwwQ0FDTkgsTUFBTyxXQUNMLElBQUllLEVBQWFMLEVBQWE5QixNQUMxQm9DLEVBQWVKLEVBQWVoQyxNQUM5QnFDLEVBQWVDLEVBQWV0QyxNQUM5QnVDLEVBQWtCQyxFQUFjeEMsTUFFaENtQyxJQUFlbEQsR0FBY21ELElBQWlCbkMsR0FBZ0JvQyxJQUFpQmhDLEdBQWdCa0MsSUFBb0JqQyxJQUNySG1DLGNBQWN4RCxFQUFZa0QsRUFBWUMsRUFBY0MsRUFBY0UsR0FDbEV4QixFQUF1QnZCLGFBS3pCa0QsRUFBMEJ0RCxFQUFHLFNBQVUsQ0FDekM0QixNQUFTLG9DQUdQc0IsRUFBaUJsRCxFQUFHLFdBQVksQ0FDbEM0QixNQUFTLDBCQUNUdkQsTUFBTzRDLElBR0xzQyxFQUF5QnZELEVBQUcsU0FBVSxDQUN4QzRCLE1BQVMsdUNBR1B3QixFQUFnQnBELEVBQUcsWUFBYSxDQUNsQzRCLE1BQVMsK0JBR1gsSUFBSyxJQUFJNEIsRUFBSSxFQUFHQSxFQUFJcEYsYUFBYVksT0FBUXdFLElBQ25DcEYsYUFBYW9GLEdBQUduRixRQUFVNkMsRUFDNUJrQyxFQUFjL0MsT0FBTyxJQUFJb0QsT0FBT3JGLGFBQWFvRixHQUFHbEYsTUFBT0YsYUFBYW9GLEdBQUduRixPQUFPLEdBQU0sSUFFcEYrRSxFQUFjL0MsT0FBTyxJQUFJb0QsT0FBT3JGLGFBQWFvRixHQUFHbEYsTUFBT0YsYUFBYW9GLEdBQUduRixRQUkzRSxJQUFJcUYsRUFBcUIxRCxFQUFHLFNBQVUsQ0FDcEM0QixNQUFTLHNCQUdQK0IsRUFBWTNELEVBQUcsWUFBYSxDQUM5QjRCLE1BQVMsa0NBQ1RPLEtBQU0scUNBQ05ILE1BQU8sV0FDTEgsRUFBaUIxRCxPQUNqQjhELEVBQWMvRCxPQUNkd0UsRUFBYTlCLElBQUlmLEdBQ2pCK0MsRUFBZWhDLElBQUlDLEdBQ25CcUMsRUFBZXRDLElBQUlLLEdBQ25CbUMsRUFBY3hDLElBQUlNLE1BSXRCdUIsRUFBc0JwQyxPQUFPcUMsR0FDN0JDLEVBQXdCdEMsT0FBT3VDLEdBQy9CVyxFQUF1QmxELE9BQU8rQyxHQUM5QlAsRUFBbUJ4QyxPQUFPeUMsR0FDMUJRLEVBQXdCakQsT0FBTzZDLEdBQy9CUSxFQUFtQnJELE9BQU9zRCxHQUUxQjFCLEVBQWM1QixPQUFPb0MsR0FDckJSLEVBQWM1QixPQUFPc0MsR0FDckJWLEVBQWM1QixPQUFPd0MsR0FDckJaLEVBQWM1QixPQUFPaUQsR0FDckJyQixFQUFjNUIsT0FBT2tELEdBQ3JCdEIsRUFBYzVCLE9BQU9xRCxHQUVyQnRCLEVBQW1CL0IsT0FBT2dDLEdBRTFCUixFQUFpQnhCLE9BQU95QixHQUN4QkQsRUFBaUJ4QixPQUFPNkIsR0FDeEJMLEVBQWlCeEIsT0FBTytCLEdBRXhCVCxFQUF1QnRCLE9BQU93QixHQUM5QkYsRUFBdUJ0QixPQUFPNEIsR0FFOUJqQyxFQUFFLHVCQUF1QkssT0FBT3NCLEdBRXBCaUMsTUFBTUMsT0FBTyxDQUN2QkMsR0FBSWxCLEVBQWUsR0FDbkJtQixNQUFPLE9BQ1BDLFFBQVNuRCxFQUNUb0QsYUFBYSxFQUNiQyxTQUFVLENBQ1Isd0JBQ0Esd0JBQ0Esd0JBQ0Esd0JBQ0Esd0JBQ0Esd0JBQ0EseUJBRUZDLFdBQVksQ0FDVkMsU0FBUyxFQUNUQyxTQUFTLEVBQ1RDLEtBQUssRUFDTEMsWUFBYSxDQUNYQyxLQUFLLEVBQ0xDLE1BQU0sRUFDTkMsTUFBTSxFQUNOQyxNQUFNLEVBQ05DLE1BQU0sRUFDTkMsT0FBTyxFQUNQQyxPQUFPLEVBQ1BDLE1BQU0sTUFLTkMsR0FBRyxPQUFRLENBQUNDLEVBQU9DLEtBQ3ZCdEMsRUFBZWhDLElBQUlxRSxFQUFNbEUsU0FBU0MsU0FBUyxJQUMzQ2tFLEVBQVNoSCxTQUtiLFNBQVNtRixjQUFjeEQsRUFBWXNGLEVBQWV0RSxFQUFjSSxFQUFjQyxHQUM1RS9CLFFBQVFDLFFBQVFDLE1BQU1nQyxJQUFJLENBQUVDLENBQUM2RCxHQUFpQixDQUFDdEUsRUFBY0ksRUFBY0MsS0FBb0IzQixLQUFLLEtBQzlGTSxJQUFlc0YsRUFFakJoRyxRQUFRQyxRQUFRQyxNQUFNZSxPQUFPUCxHQUFZTixLQUFLLEtBQzVDTyxlQUFlcUYsRUFBZXRFLEVBQWNJLEVBQWNDLElBQ3pEekMsU0FHSHFCLGVBQWVxRixFQUFldEUsRUFBY0ksRUFBY0MsSUFFM0R6QyxTQUlMLFNBQVMyRyxXQUNQcEYsRUFBRSxnQ0FBZ0NxRixLQUFLLENBQUNDLEVBQU9DLEtBQzdDQSxFQUFRbkYsV0FFVmpCLFFBQVFDLFFBQVFDLE1BQU15RixRQUN0QmxGLHNCQUFzQnpCLE1BSXhCLFNBQVNxSCxtQkFBbUJ6RCxHQUMxQixJQUFJMEQsRUFBTyxJQUFJQyxLQUFLLENBQUMzRCxHQUFPLENBQUU0RCxLQUFNLHFCQVNwQyxPQUxtQixPQUFmcEgsWUFDRnFILE9BQU9DLElBQUlDLGdCQUFnQnZILFlBRzdCQSxXQUFhcUgsT0FBT0MsSUFBSUUsZ0JBQWdCTixHQUNqQ2xILFdBSVQsU0FBU3lILGVBQ1A3RyxRQUFRQyxRQUFRQyxNQUFNQyxJQUFJLE1BQU1DLEtBQU1DLElBQ3BDLElBQUlDLEVBQWVDLE9BQU9DLEtBQUtILEdBQzNCeUcsRUFBaUIsR0FFckIsR0FBSXhHLEVBQWFULE9BQVMsRUFBRyxDQUMzQixJQUFLLElBQUlhLEtBQWNKLEVBQ3JCd0csRUFBZUMsS0FBSyxDQUNsQkMsSUFBUXRHLEVBQ1JvRixNQUFVekYsRUFBUUssR0FBWSxHQUM5QnZCLE1BQVVrQixFQUFRSyxHQUFZLEdBQzlCdUcsU0FBYTVHLEVBQVFLLEdBQVksS0FJckMsSUFBSXdHLEVBQXNCQyxLQUFLQyxVQUFVTixHQUNyQ08sRUFBT0MsU0FBU0MsY0FBYyxLQUNsQ0YsRUFBS0csYUFBYSxXQUFZLHVCQUM5QkgsRUFBS0ksS0FBT3BCLG1CQUFtQmEsR0FDL0JJLFNBQVNJLEtBQUtDLFlBQVlOLEdBRzFCWixPQUFPbUIsdUJBQXNCLFdBQzNCLElBQUlDLEVBQVEsSUFBSUMsV0FBVyxTQUMzQlQsRUFBS1UsY0FBY0YsR0FDbkJQLFNBQVNJLEtBQUtNLFlBQVlYLFFBRzdCL0gsU0FJTCxTQUFTMkksZUFDUCxJQUFJQyxFQUFrQlosU0FBU2EsZUFBZSxjQUMxQ0MsRUFBYUYsRUFBZ0JHLE1BQU0sR0FDdkMsTUFBTUMsRUFBUyxJQUFJQyxXQUduQkQsRUFBT0UsaUJBQWlCLFFBQVEsV0FDOUIsSUFBSUMsRUFBb0J0QixLQUFLdUIsTUFBTUosRUFBT3RHLFFBRXRDeUcsRUFBa0I1SSxPQUFTLEdBQzdCNEksRUFBa0JFLFNBQVEsU0FBU0MsR0FDakN6SCxhQUFheUgsRUFBVTVCLElBQUs0QixFQUFVOUMsTUFBTzhDLEVBQVV6SixNQUFPeUosRUFBVTNCLFVBQVUsTUFJdEZpQixFQUFnQmhKLE1BQVEsTUFHMUJvSixFQUFPTyxXQUFXVCxHQUdwQnZILEVBQUV5RyxVQUFVd0IsTUFBTSxLQUVoQi9JLGFBRUFjLEVBQUUsU0FBU2dDLE1BQU0sS0FDZjFCLGlCQUdGTixFQUFFLFVBQVVnQyxNQUFNLEtBQ2hCb0QsYUFHRnBGLEVBQUUsa0JBQWtCZ0MsTUFBTSxLQUN4QmhDLEVBQUUsNEJBQTRCa0ksV0FHaENsSSxFQUFFLFdBQVdnQyxNQUFNLEtBQ2pCZ0UsaUJBR0ZoRyxFQUFFLFdBQVdnQyxNQUFNLEtBQ2pCb0YsaUJBR0ZwSCxFQUFFeUcsVUFBVTBCLFNBQVEsU0FBU25CLEdBTzNCLEdBTGtCLFVBQWRBLEVBQU1vQixLQUFpQyxnQkFBZHBCLEVBQU1vQixLQUNqQzlILGVBSWdCLFdBQWQwRyxFQUFNb0IsSUFHUixPQUFPLEVBRlB4QyxPQUFPeUMsV0FNWDdKLE1BQVFvRixNQUFNQyxPQUFPLENBQ25CQyxHQUFJLGdCQUNKQyxNQUFPLE9BQ1BFLGFBQWEsRUFDYkMsU0FBVSxDQUNSLHdCQUNBLHdCQUNBLHdCQUNBLHdCQUNBLHdCQUNBLHdCQUNBLHlCQUVGQyxXQUFZLENBQ1ZDLFNBQVMsRUFDVEMsU0FBUyxFQUNUQyxLQUFLLEVBQ0xDLFlBQWEsQ0FDWEMsS0FBSyxFQUNMQyxNQUFNLEVBQ05DLE1BQU0sRUFDTkMsTUFBTSxFQUNOQyxNQUFNLEVBQ05DLE9BQU8sRUFDUEMsT0FBTyxFQUNQQyxNQUFNLE1BS1p2RyxNQUFNd0csR0FBRyxPQUFRLENBQUNDLEVBQU9DLEtBRXZCQSxFQUFTaEgiLCJmaWxlIjoiZW52aXJvbm1lbnQtbWFya2VyLm1pbi5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8qIEluaXRpdGFsaXNlIGNvbnN0YW50ICovXHJcbmNvbnN0IGhpZGUgPSAnbm9uZSc7XHJcbmNvbnN0IHNob3cgPSAnYmxvY2snO1xyXG5jb25zdCBwb3NpdGlvbnNNYXAgPSBbXHJcbiAge3ZhbHVlOiAndG9wLWxlZnQnLCBsYWJlbDogJ1RvcCBMZWZ0J30sXHJcbiAge3ZhbHVlOiAndG9wLXJpZ2h0JywgbGFiZWw6ICdUb3AgUmlnaHQnfSxcclxuICB7dmFsdWU6ICdib3R0b20tbGVmdCcsIGxhYmVsOiAnQm90dG9tIExlZnQnfSxcclxuICB7dmFsdWU6ICdib3R0b20tcmlnaHQnLCBsYWJlbDogJ0JvdHRvbSBSaWdodCd9XHJcbl07XHJcbmxldCBleHBvcnRGaWxlID0gbnVsbDtcclxubGV0IHBpY2tyID0gbnVsbDtcclxuXHJcbi8qIEdlbmVyaWMgZXJyb3IgaGFuZGxlciAqL1xyXG5mdW5jdGlvbiBvbkVycm9yKGVycm9yKSB7XHJcbiAgY29uc29sZS5sb2coZXJyb3IpO1xyXG59XHJcblxyXG5mdW5jdGlvbiB0cnVuY2F0ZVN0cmluZyhzdHIsIG51bSkge1xyXG4gIGlmIChzdHIubGVuZ3RoIDw9IG51bSkge1xyXG4gICAgcmV0dXJuIHN0clxyXG4gIH1cclxuICByZXR1cm4gc3RyLnNsaWNlKDAsIG51bSkgKyAnLi4uJ1xyXG59XHJcblxyXG5mdW5jdGlvbiBpbml0aWFsaXplKCkge1xyXG4gIGJyb3dzZXIuc3RvcmFnZS5sb2NhbC5nZXQobnVsbCkudGhlbigocmVzdWx0cykgPT4ge1xyXG4gICAgbGV0IHNldHRpbmdzVXJscyA9IE9iamVjdC5rZXlzKHJlc3VsdHMpO1xyXG4gICAgc2V0dGluZ3NVcmxzLmxlbmd0aCA+IDAgPyBzaG93T3JIaWRlRW1wdHlOb3RpY2UoaGlkZSkgOiBzaG93T3JIaWRlRW1wdHlOb3RpY2Uoc2hvdyk7XHJcbiAgICBmb3IgKGxldCBzZXR0aW5nVXJsIG9mIHNldHRpbmdzVXJscykge1xyXG4gICAgICBkaXNwbGF5U2V0dGluZyhzZXR0aW5nVXJsLCByZXN1bHRzW3NldHRpbmdVcmxdWzBdLCByZXN1bHRzW3NldHRpbmdVcmxdWzFdLCByZXN1bHRzW3NldHRpbmdVcmxdWzJdKTtcclxuICAgIH1cclxuICB9LCBvbkVycm9yKTtcclxufVxyXG5cclxuZnVuY3Rpb24gc2hvd09ySGlkZUVtcHR5Tm90aWNlKGFjdGlvbiA9IG51bGwpIHtcclxuICBpZiAoYWN0aW9uICE9PSBzaG93ICYmIGFjdGlvbiAhPT0gaGlkZSkge1xyXG4gICAgYnJvd3Nlci5zdG9yYWdlLmxvY2FsLmdldChudWxsKS50aGVuKChyZXN1bHRzKSA9PiB7XHJcbiAgICAgIGxldCBzZXR0aW5nc1VybHMgPSBPYmplY3Qua2V5cyhyZXN1bHRzKTtcclxuICAgICAgJCgnLmVtcHR5LW5vdGljZScpLmNzcygnZGlzcGxheScsIHNldHRpbmdzVXJscy5sZW5ndGggPiAwID8gJ25vbmUnIDogJ2Jsb2NrJyk7XHJcbiAgICB9LCBvbkVycm9yKTtcclxuICB9IGVsc2Uge1xyXG4gICAgJCgnLmVtcHR5LW5vdGljZScpLmNzcygnZGlzcGxheScsIGFjdGlvbik7XHJcbiAgfVxyXG59XHJcblxyXG4vKiBTaG93IGVycm9yIG1lc3NhZ2UgKi9cclxuZnVuY3Rpb24gc2hvd0Vycm9yTWVzc2FnZSh0ZXh0TXNnKSB7XHJcbiAgaWYgKCQoJy5vdXRlci13cmFwcGVyIC5tZXNzYWdlLWNvbnRhaW5lciAuZXJyb3InKS5sZW5ndGgpIHtcclxuICAgICQoJy5vdXRlci13cmFwcGVyIC5tZXNzYWdlLWNvbnRhaW5lciAuZXJyb3InKS5yZW1vdmUoKTtcclxuICAgICQoJy5vdXRlci13cmFwcGVyIC5tZXNzYWdlLWNvbnRhaW5lcicpLmFwcGVuZCgnPGRpdiBjbGFzcz1cImVycm9yIGNvbC0xMlwiPicrdGV4dE1zZysnPC9kaXY+Jyk7XHJcbiAgfSBlbHNlIHtcclxuICAgICQoJy5vdXRlci13cmFwcGVyIC5tZXNzYWdlLWNvbnRhaW5lcicpLmFwcGVuZCgnPGRpdiBjbGFzcz1cImVycm9yIGNvbC0xMlwiPicrdGV4dE1zZysnPC9kaXY+Jyk7XHJcbiAgfVxyXG59XHJcblxyXG4vKiBBZGQgYSBzZXR0aW5nIHRvIHRoZSBkaXNwbGF5IGFuZCBzdG9yYWdlICovXHJcbmZ1bmN0aW9uIHNhdmVTZXR0aW5ncyh1cmxJbiwgY29sb3JJbiwgbGFiZWxJbiwgcG9zaXRpb25JbiwgaW1wb3J0RmxhZyA9IGZhbHNlKSB7XHJcbiAgbGV0IHNldHRpbmdVcmwgPSBpbXBvcnRGbGFnID8gdXJsSW4gOiAkKCcuc2V0dGluZ3MtaW5wdXQgI3VybCcpLnZhbCgpLFxyXG4gICAgICBzZXR0aW5nQ29sb3IgPSBpbXBvcnRGbGFnID8gY29sb3JJbiA6IHBpY2tyLmdldFNlbGVjdGVkQ29sb3IoKS50b0hFWEEoKS50b1N0cmluZygwKSxcclxuICAgICAgc2V0dGluZ0xhYmVsID0gaW1wb3J0RmxhZyA/IGxhYmVsSW4gOiAkKCcuc2V0dGluZ3MtaW5wdXQgI2xhYmVsJykudmFsKCksXHJcbiAgICAgIHNldHRpbmdQb3NpdGlvbiA9ICBpbXBvcnRGbGFnID8gcG9zaXRpb25JbiA6ICQoJy5zZXR0aW5ncy1pbnB1dCAjcG9zaXRpb24nKS52YWwoKTtcclxuXHJcbiAgaWYgKHNldHRpbmdVcmwgIT09ICcnICYmIHNldHRpbmdDb2xvciAhPT0gJycgJiYgc2V0dGluZ0xhYmVsICE9PSAnJykge1xyXG4gICAgYnJvd3Nlci5zdG9yYWdlLmxvY2FsLmdldChzZXR0aW5nVXJsKS50aGVuKChyZXN1bHQpID0+IHtcclxuICAgICAgbGV0IG9ialRlc3QgPSBPYmplY3Qua2V5cyhyZXN1bHQpO1xyXG5cclxuICAgICAgaWYgKG9ialRlc3QubGVuZ3RoIDwgMSkge1xyXG4gICAgICAgIGlmICgkKCcub3V0ZXItd3JhcHBlciAubWVzc2FnZS1jb250YWluZXIgLmVycm9yJykubGVuZ3RoKSB7XHJcbiAgICAgICAgICAkKCcub3V0ZXItd3JhcHBlciAubWVzc2FnZS1jb250YWluZXIgLmVycm9yJykucmVtb3ZlKCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAkKCcuc2V0dGluZ3MtaW5wdXQgI3VybCcpLnZhbCgnJyk7XHJcbiAgICAgICAgJCgnLnNldHRpbmdzLWlucHV0ICNsYWJlbCcpLnZhbCgnJyk7XHJcbiAgICAgICAgJCgnLnNldHRpbmdzLWlucHV0ICNwb3NpdGlvbicpLnZhbCgndG9wLWxlZnQnKTtcclxuXHJcbiAgICAgICAgc3RvcmVTZXR0aW5nKHNldHRpbmdVcmwsIHNldHRpbmdDb2xvciwgc2V0dGluZ0xhYmVsLCBzZXR0aW5nUG9zaXRpb24pO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIC8vIER1cGxpY2F0ZSBtYXJrZXIgZXJyb3IgbWVzc2FnZVxyXG4gICAgICAgIHNob3dFcnJvck1lc3NhZ2UoJ01hcmtlciBmb3IgdGhpcyBVUkwgYWxyZWFkeSBleGlzdHMhJyk7XHJcbiAgICAgIH1cclxuICAgIH0sIG9uRXJyb3IpO1xyXG4gIH0gZWxzZSB7XHJcbiAgICAvLyBFbXB0eSBpbnB1dCBlcnJvciBtZXNzYWdlXHJcbiAgICBzZXR0aW5nTGFiZWwgPT09ICcnID8gc2hvd0Vycm9yTWVzc2FnZSgnRW50ZXIgTGFiZWwgIScpIDogc2hvd0Vycm9yTWVzc2FnZSgnRW50ZXIgVVJMICEnKTtcclxuICB9XHJcbn1cclxuXHJcbi8qIFN0b3JlIGEgbmV3IHNldHRpbmcgaW4gbG9jYWwgc3RvcmFnZSAqL1xyXG5mdW5jdGlvbiBzdG9yZVNldHRpbmcoc2V0dGluZ1VybCwgc2V0dGluZ0NvbG9yLCBzZXR0aW5nTGFiZWwsIHNldHRpbmdQb3NpdGlvbikge1xyXG4gIGJyb3dzZXIuc3RvcmFnZS5sb2NhbC5zZXQoeyBbc2V0dGluZ1VybF0gOiBbc2V0dGluZ0NvbG9yLCBzZXR0aW5nTGFiZWwsIHNldHRpbmdQb3NpdGlvbl0gfSkudGhlbigoKSA9PiB7XHJcbiAgICBzaG93T3JIaWRlRW1wdHlOb3RpY2UoaGlkZSk7XHJcbiAgICBkaXNwbGF5U2V0dGluZyhzZXR0aW5nVXJsLCBzZXR0aW5nQ29sb3IsIHNldHRpbmdMYWJlbCwgc2V0dGluZ1Bvc2l0aW9uKTtcclxuICB9LCBvbkVycm9yKTtcclxufVxyXG5cclxuLyogRGlzcGxheSBhIHNldHRpbmcgaW4gdGhlIHNldHRpbmcgYm94ICovXHJcbmZ1bmN0aW9uIGRpc3BsYXlTZXR0aW5nKHNldHRpbmdVcmwsIHNldHRpbmdDb2xvciwgc2V0dGluZ0xhYmVsLCBzZXR0aW5nUG9zaXRpb24pIHtcclxuICBsZXQgc2V0dGluZ1Bvc2l0aW9uRGlzcGxheSA9IHBvc2l0aW9uc01hcC5yZWR1Y2UoZnVuY3Rpb24oYWNjdW11bGF0b3IsIGN1cnJlbnRWYWx1ZSkge1xyXG4gICAgaWYgKGN1cnJlbnRWYWx1ZS52YWx1ZSA9PSBzZXR0aW5nUG9zaXRpb24pIHtcclxuICAgICAgYWNjdW11bGF0b3IgPSBjdXJyZW50VmFsdWUubGFiZWw7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gYWNjdW11bGF0b3I7XHJcbiAgfSwge30pO1xyXG5cclxuICBsZXQgaW5uZXJTZXR0aW5nc0NvbnRhaW5lciA9ICQoIFwiPGRpdi8+XCIsIHsgXCJjbGFzc1wiOiBcInNldHRpbmdcIiB9KTtcclxuICBsZXQgZGlzcGxheUNvbnRhaW5lciA9ICQoIFwiPGRpdi8+XCIsIHsgXCJjbGFzc1wiOiBcInJvdyBuby1ndXR0ZXJzIG1iLTIgZGlzcGxheS1jb250YWluZXJcIiB9KTtcclxuXHJcbiAgbGV0IGRpc3BsYXlMYWJlbFVybCA9ICQoIFwiPGRpdi8+XCIsIHtcclxuICAgIFwiY2xhc3NcIjogXCJjb2wtMTAgcHItMiBkaXNwbGF5LWxhYmVsVXJsXCIsXHJcbiAgICB0ZXh0OiBzZXR0aW5nTGFiZWwgKyAnICgnICsgc2V0dGluZ1VybCArICcpIGF0ICcgKyBzZXR0aW5nUG9zaXRpb25EaXNwbGF5LFxyXG4gICAgY2xpY2s6IGZ1bmN0aW9uKCkge1xyXG4gICAgICBkaXNwbGF5Q29udGFpbmVyLmhpZGUoKTtcclxuICAgICAgZWRpdENvbnRhaW5lci5zaG93KCk7XHJcbiAgICB9XHJcbiAgfSk7XHJcblxyXG4gIGxldCBkaXNwbGF5Q29sb3IgPSAkKCBcIjxkaXYvPlwiLCB7XHJcbiAgICBcImNsYXNzXCI6IFwiY29sLTEgcHItMiBkaXNwbGF5LWNvbG9yXCIsXHJcbiAgICBodG1sOiAnPGRpdiBzdHlsZT1cImJhY2tncm91bmQtY29sb3I6ICcgKyBzZXR0aW5nQ29sb3IgKyAnO1wiPjwvZGl2PicsXHJcbiAgICBjbGljazogZnVuY3Rpb24oKSB7XHJcbiAgICAgIGRpc3BsYXlDb250YWluZXIuaGlkZSgpO1xyXG4gICAgICBlZGl0Q29udGFpbmVyLnNob3coKTtcclxuICAgIH1cclxuICB9KTtcclxuXHJcbiAgbGV0IGRlbGV0ZUJ0bkNvbnRhaW5lciA9ICQoIFwiPGRpdi8+XCIsIHtcclxuICAgIFwiY2xhc3NcIjogXCJjb2wtMSBkaXNwbGF5LWRlbGV0ZVwiXHJcbiAgfSk7XHJcblxyXG4gIGxldCBkZWxldGVCdG4gPSAkKCBcIjxidXR0b24vPlwiLCB7XHJcbiAgICBcImNsYXNzXCI6IFwiYnRuIGJ0bi1kYW5nZXIgYnRuLXNtIGRlbGV0ZVwiLFxyXG4gICAgaHRtbDogJzxpIGNsYXNzPVwiZmFzIGZhLXRyYXNoIGZhLWxnXCI+PC9pPicsXHJcbiAgICBjbGljazogZnVuY3Rpb24oKSB7XHJcbiAgICAgICQodGhpcykucGFyZW50KCkucGFyZW50KCkucGFyZW50KCkucmVtb3ZlKCk7XHJcbiAgICAgIGJyb3dzZXIuc3RvcmFnZS5sb2NhbC5yZW1vdmUoc2V0dGluZ1VybCk7XHJcbiAgICAgIHNob3dPckhpZGVFbXB0eU5vdGljZSgpO1xyXG4gICAgfVxyXG4gIH0pO1xyXG5cclxuICBsZXQgZWRpdENvbnRhaW5lciA9ICQoIFwiPGRpdi8+XCIsIHtcclxuICAgIFwiY2xhc3NcIjogXCJyb3cgbm8tZ3V0dGVycyBtYi0yIGVkaXQtY29udGFpbmVyXCIsXHJcbiAgICBcInN0eWxlXCI6IFwiZGlzcGxheTogbm9uZTtcIlxyXG4gIH0pO1xyXG5cclxuICBsZXQgZWRpdFVybElucHV0Q29udGFpbmVyID0gJCggXCI8ZGl2Lz5cIiwge1xyXG4gICAgXCJjbGFzc1wiOiBcImNvbC0xMCBwci0xIG1iLTIgZWRpdC11cmwtY29udGFpbmVyXCJcclxuICB9KTtcclxuXHJcbiAgbGV0IGVkaXRVcmxJbnB1dCA9ICQoIFwiPGlucHV0Lz5cIiwge1xyXG4gICAgXCJjbGFzc1wiOiBcImZvcm0tY29udHJvbCBlZGl0LXVybFwiLFxyXG4gICAgdmFsdWU6IHNldHRpbmdVcmxcclxuICB9KTtcclxuXHJcbiAgbGV0IGVkaXRDb2xvcklucHV0Q29udGFpbmVyID0gJCggXCI8ZGl2Lz5cIiwge1xyXG4gICAgXCJjbGFzc1wiOiBcImNvbC0xIHByLTEgbWItMiBlZGl0LWNvbG9yXCJcclxuICB9KTtcclxuXHJcbiAgbGV0IGVkaXRDb2xvcklucHV0ID0gJCggXCI8aW5wdXQvPlwiLCB7XHJcbiAgICBcImNsYXNzXCI6IFwiY29sb3ItcGlja2VyXCIsXHJcbiAgICB2YWx1ZTogc2V0dGluZ0NvbG9yXHJcbiAgfSk7XHJcblxyXG4gIGxldCB1cGRhdGVCdG5Db250YWluZXIgPSAkKCBcIjxkaXYvPlwiLCB7XHJcbiAgICBcImNsYXNzXCI6IFwiY29sLTEgbWItMiBlZGl0LWRlbGV0ZVwiXHJcbiAgfSk7XHJcblxyXG4gIGxldCB1cGRhdGVCdG4gPSAkKCBcIjxidXR0b24vPlwiLCB7XHJcbiAgICBcImNsYXNzXCI6IFwiYnRuIGJ0bi1zdWNjZXNzIGJ0bi1zbSB1cGRhdGVcIixcclxuICAgIGh0bWw6ICc8aSBjbGFzcz1cImZhcyBmYS1wZW5jaWwtYWx0IGZhLWxnXCI+PC9pPicsXHJcbiAgICBjbGljazogZnVuY3Rpb24oKSB7XHJcbiAgICAgIGxldCB1cmxFZGl0VmFsID0gZWRpdFVybElucHV0LnZhbCgpO1xyXG4gICAgICBsZXQgY29sb3JFZGl0VmFsID0gZWRpdENvbG9ySW5wdXQudmFsKCk7XHJcbiAgICAgIGxldCBsYWJlbEVkaXRWYWwgPSBlZGl0TGFiZWxJbnB1dC52YWwoKTtcclxuICAgICAgbGV0IHBvc2l0aW9uRWRpdFZhbCA9IG9wdGlvbnNTZWxlY3QudmFsKCk7XHJcblxyXG4gICAgICBpZiAodXJsRWRpdFZhbCAhPT0gc2V0dGluZ1VybCB8fCBjb2xvckVkaXRWYWwgIT09IHNldHRpbmdDb2xvciB8fCBsYWJlbEVkaXRWYWwgIT09IHNldHRpbmdMYWJlbCB8fCBwb3NpdGlvbkVkaXRWYWwgIT09IHNldHRpbmdQb3NpdGlvbikge1xyXG4gICAgICAgIHVwZGF0ZVNldHRpbmcoc2V0dGluZ1VybCwgdXJsRWRpdFZhbCwgY29sb3JFZGl0VmFsLCBsYWJlbEVkaXRWYWwsIHBvc2l0aW9uRWRpdFZhbCk7XHJcbiAgICAgICAgaW5uZXJTZXR0aW5nc0NvbnRhaW5lci5yZW1vdmUoKTtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gIH0pO1xyXG5cclxuICBsZXQgZWRpdExhYmVsSW5wdXRDb250YWluZXIgPSAkKCBcIjxkaXYvPlwiLCB7XHJcbiAgICBcImNsYXNzXCI6IFwiY29sLTYgcHItMiBlZGl0LWxhYmVsLWNvbnRhaW5lclwiXHJcbiAgfSk7XHJcblxyXG4gIGxldCBlZGl0TGFiZWxJbnB1dCA9ICQoIFwiPGlucHV0Lz5cIiwge1xyXG4gICAgXCJjbGFzc1wiOiBcImZvcm0tY29udHJvbCBlZGl0LWxhYmVsXCIsXHJcbiAgICB2YWx1ZTogc2V0dGluZ0xhYmVsXHJcbiAgfSk7XHJcblxyXG4gIGxldCBvcHRpb25zU2VsZWN0Q29udGFpbmVyID0gJCggXCI8ZGl2Lz5cIiwge1xyXG4gICAgXCJjbGFzc1wiOiBcImNvbC01IHByLTIgZWRpdC1wb3NpdGlvbi1jb250YWluZXJcIlxyXG4gIH0pO1xyXG5cclxuICBsZXQgb3B0aW9uc1NlbGVjdCA9ICQoIFwiPHNlbGVjdC8+XCIsIHtcclxuICAgIFwiY2xhc3NcIjogXCJmb3JtLWNvbnRyb2wgZWRpdC1wb3NpdGlvblwiXHJcbiAgfSk7XHJcblxyXG4gIGZvciAobGV0IGkgPSAwOyBpIDwgcG9zaXRpb25zTWFwLmxlbmd0aDsgaSsrKSB7XHJcbiAgICBpZiAocG9zaXRpb25zTWFwW2ldLnZhbHVlID09PSBzZXR0aW5nUG9zaXRpb24pIHtcclxuICAgICAgb3B0aW9uc1NlbGVjdC5hcHBlbmQobmV3IE9wdGlvbihwb3NpdGlvbnNNYXBbaV0ubGFiZWwsIHBvc2l0aW9uc01hcFtpXS52YWx1ZSwgdHJ1ZSwgdHJ1ZSkpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgb3B0aW9uc1NlbGVjdC5hcHBlbmQobmV3IE9wdGlvbihwb3NpdGlvbnNNYXBbaV0ubGFiZWwsIHBvc2l0aW9uc01hcFtpXS52YWx1ZSkpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgbGV0IGNhbmNlbEJ0bkNvbnRhaW5lciA9ICQoIFwiPGRpdi8+XCIsIHtcclxuICAgIFwiY2xhc3NcIjogXCJjb2wtMSBlZGl0LWNhbmNlbFwiXHJcbiAgfSk7XHJcblxyXG4gIGxldCBjYW5jZWxCdG4gPSAkKCBcIjxidXR0b24vPlwiLCB7XHJcbiAgICBcImNsYXNzXCI6IFwiYnRuIGJ0bi1zZWNvbmRhcnkgYnRuLXNtIGNhbmNlbFwiLFxyXG4gICAgaHRtbDogJzxpIGNsYXNzPVwiZmFzIGZhLXRpbWVzIGZhLWxnXCI+PC9pPicsXHJcbiAgICBjbGljazogZnVuY3Rpb24oKSB7XHJcbiAgICAgIGRpc3BsYXlDb250YWluZXIuc2hvdygpO1xyXG4gICAgICBlZGl0Q29udGFpbmVyLmhpZGUoKTtcclxuICAgICAgZWRpdFVybElucHV0LnZhbChzZXR0aW5nVXJsKTtcclxuICAgICAgZWRpdENvbG9ySW5wdXQudmFsKHNldHRpbmdDb2xvcik7XHJcbiAgICAgIGVkaXRMYWJlbElucHV0LnZhbChzZXR0aW5nTGFiZWwpO1xyXG4gICAgICBvcHRpb25zU2VsZWN0LnZhbChzZXR0aW5nUG9zaXRpb24pO1xyXG4gICAgfVxyXG4gIH0pO1xyXG5cclxuICBlZGl0VXJsSW5wdXRDb250YWluZXIuYXBwZW5kKGVkaXRVcmxJbnB1dCk7XHJcbiAgZWRpdENvbG9ySW5wdXRDb250YWluZXIuYXBwZW5kKGVkaXRDb2xvcklucHV0KTtcclxuICBvcHRpb25zU2VsZWN0Q29udGFpbmVyLmFwcGVuZChvcHRpb25zU2VsZWN0KTtcclxuICB1cGRhdGVCdG5Db250YWluZXIuYXBwZW5kKHVwZGF0ZUJ0bik7XHJcbiAgZWRpdExhYmVsSW5wdXRDb250YWluZXIuYXBwZW5kKGVkaXRMYWJlbElucHV0KTtcclxuICBjYW5jZWxCdG5Db250YWluZXIuYXBwZW5kKGNhbmNlbEJ0bik7XHJcblxyXG4gIGVkaXRDb250YWluZXIuYXBwZW5kKGVkaXRVcmxJbnB1dENvbnRhaW5lcik7XHJcbiAgZWRpdENvbnRhaW5lci5hcHBlbmQoZWRpdENvbG9ySW5wdXRDb250YWluZXIpO1xyXG4gIGVkaXRDb250YWluZXIuYXBwZW5kKHVwZGF0ZUJ0bkNvbnRhaW5lcik7XHJcbiAgZWRpdENvbnRhaW5lci5hcHBlbmQoZWRpdExhYmVsSW5wdXRDb250YWluZXIpO1xyXG4gIGVkaXRDb250YWluZXIuYXBwZW5kKG9wdGlvbnNTZWxlY3RDb250YWluZXIpO1xyXG4gIGVkaXRDb250YWluZXIuYXBwZW5kKGNhbmNlbEJ0bkNvbnRhaW5lcik7XHJcblxyXG4gIGRlbGV0ZUJ0bkNvbnRhaW5lci5hcHBlbmQoZGVsZXRlQnRuKTtcclxuXHJcbiAgZGlzcGxheUNvbnRhaW5lci5hcHBlbmQoZGlzcGxheUxhYmVsVXJsKTtcclxuICBkaXNwbGF5Q29udGFpbmVyLmFwcGVuZChkaXNwbGF5Q29sb3IpO1xyXG4gIGRpc3BsYXlDb250YWluZXIuYXBwZW5kKGRlbGV0ZUJ0bkNvbnRhaW5lcik7XHJcblxyXG4gIGlubmVyU2V0dGluZ3NDb250YWluZXIuYXBwZW5kKGRpc3BsYXlDb250YWluZXIpO1xyXG4gIGlubmVyU2V0dGluZ3NDb250YWluZXIuYXBwZW5kKGVkaXRDb250YWluZXIpO1xyXG5cclxuICAkKCcuc2V0dGluZ3MtY29udGFpbmVyJykuYXBwZW5kKGlubmVyU2V0dGluZ3NDb250YWluZXIpO1xyXG5cclxuICBsZXQgcGlja3IgPSBQaWNrci5jcmVhdGUoe1xyXG4gICAgZWw6IGVkaXRDb2xvcklucHV0WzBdLFxyXG4gICAgdGhlbWU6ICduYW5vJyxcclxuICAgIGRlZmF1bHQ6IHNldHRpbmdDb2xvcixcclxuICAgIHVzZUFzQnV0dG9uOiBmYWxzZSxcclxuICAgIHN3YXRjaGVzOiBbXHJcbiAgICAgICdyZ2JhKDI0NCwgNjcsICA1NCwgMSknLFxyXG4gICAgICAncmdiYSgyMzMsIDMwLCAgOTksIDEpJyxcclxuICAgICAgJ3JnYmEoMTU2LCAzOSwgMTc2LCAxKScsXHJcbiAgICAgICdyZ2JhKDEwMywgNTgsIDE4MywgMSknLFxyXG4gICAgICAncmdiYSg2MywgIDgxLCAxODEsIDEpJyxcclxuICAgICAgJ3JnYmEoMzMsIDE1MCwgMjQzLCAxKScsXHJcbiAgICAgICdyZ2JhKDMsICAxNjksIDI0NCwgMSknXHJcbiAgICBdLFxyXG4gICAgY29tcG9uZW50czoge1xyXG4gICAgICBwcmV2aWV3OiB0cnVlLFxyXG4gICAgICBvcGFjaXR5OiBmYWxzZSxcclxuICAgICAgaHVlOiB0cnVlLFxyXG4gICAgICBpbnRlcmFjdGlvbjoge1xyXG4gICAgICAgIGhleDogZmFsc2UsXHJcbiAgICAgICAgcmdiYTogZmFsc2UsXHJcbiAgICAgICAgaHNsYTogZmFsc2UsXHJcbiAgICAgICAgaHN2YTogZmFsc2UsXHJcbiAgICAgICAgY215azogZmFsc2UsXHJcbiAgICAgICAgaW5wdXQ6IHRydWUsXHJcbiAgICAgICAgY2xlYXI6IGZhbHNlLFxyXG4gICAgICAgIHNhdmU6IHRydWVcclxuICAgICAgfVxyXG4gICAgfVxyXG4gIH0pO1xyXG5cclxuICBwaWNrci5vbignc2F2ZScsIChjb2xvciwgaW5zdGFuY2UpID0+IHtcclxuICAgIGVkaXRDb2xvcklucHV0LnZhbChjb2xvci50b0hFWEEoKS50b1N0cmluZygwKSk7XHJcbiAgICBpbnN0YW5jZS5oaWRlKCk7XHJcbiAgfSk7XHJcbn1cclxuXHJcbi8qIFVwZGF0ZSBzZXR0aW5ncyAqL1xyXG5mdW5jdGlvbiB1cGRhdGVTZXR0aW5nKHNldHRpbmdVcmwsIG5ld1NldHRpbmdVcmwsIHNldHRpbmdDb2xvciwgc2V0dGluZ0xhYmVsLCBzZXR0aW5nUG9zaXRpb24pIHtcclxuICBicm93c2VyLnN0b3JhZ2UubG9jYWwuc2V0KHsgW25ld1NldHRpbmdVcmxdIDogW3NldHRpbmdDb2xvciwgc2V0dGluZ0xhYmVsLCBzZXR0aW5nUG9zaXRpb25dIH0pLnRoZW4oKCkgPT4ge1xyXG4gICAgaWYgKHNldHRpbmdVcmwgIT09IG5ld1NldHRpbmdVcmwpIHtcclxuICAgICAgLy8gQ2hhbmdlZCBVUkxcclxuICAgICAgYnJvd3Nlci5zdG9yYWdlLmxvY2FsLnJlbW92ZShzZXR0aW5nVXJsKS50aGVuKCgpID0+IHtcclxuICAgICAgICBkaXNwbGF5U2V0dGluZyhuZXdTZXR0aW5nVXJsLCBzZXR0aW5nQ29sb3IsIHNldHRpbmdMYWJlbCwgc2V0dGluZ1Bvc2l0aW9uKTtcclxuICAgICAgfSwgb25FcnJvcik7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICAvLyBDaGFuZ2Ugc2V0dGluZ3NcclxuICAgICAgZGlzcGxheVNldHRpbmcobmV3U2V0dGluZ1VybCwgc2V0dGluZ0NvbG9yLCBzZXR0aW5nTGFiZWwsIHNldHRpbmdQb3NpdGlvbik7XHJcbiAgICB9XHJcbiAgfSwgb25FcnJvcik7XHJcbn1cclxuXHJcbi8qIENsZWFyIGFsbCBzZXR0aW5ncyBmcm9tIHRoZSBkaXNwbGF5IGFuZCBzdG9yYWdlICovXHJcbmZ1bmN0aW9uIGNsZWFyQWxsKCkge1xyXG4gICQoJy5zZXR0aW5ncy1jb250YWluZXIgLnNldHRpbmcnKS5lYWNoKChpbmRleCwgZWxlbWVudCkgPT4ge1xyXG4gICAgZWxlbWVudC5yZW1vdmUoKTtcclxuICB9KTtcclxuICBicm93c2VyLnN0b3JhZ2UubG9jYWwuY2xlYXIoKTtcclxuICBzaG93T3JIaWRlRW1wdHlOb3RpY2Uoc2hvdyk7XHJcbn1cclxuXHJcbi8qIE1ha2UgYSBVUkwgT2JqZWN0IGZyb20ganNvbiB0ZXh0ICovXHJcbmZ1bmN0aW9uIG1ha2VKc29uRXhwb3J0RmlsZSh0ZXh0KSB7XHJcbiAgbGV0IGRhdGEgPSBuZXcgQmxvYihbdGV4dF0sIHsgdHlwZTogJ2FwcGxpY2F0aW9uL2pzb24nIH0pO1xyXG5cclxuICAvLyBJZiB3ZSBhcmUgcmVwbGFjaW5nIGEgcHJldmlvdXNseSBnZW5lcmF0ZWQgZmlsZSB3ZSBuZWVkIHRvXHJcbiAgLy8gbWFudWFsbHkgcmV2b2tlIHRoZSBvYmplY3QgVVJMIHRvIGF2b2lkIG1lbW9yeSBsZWFrcy5cclxuICBpZiAoZXhwb3J0RmlsZSAhPT0gbnVsbCkge1xyXG4gICAgd2luZG93LlVSTC5yZXZva2VPYmplY3RVUkwoZXhwb3J0RmlsZSk7XHJcbiAgfVxyXG5cclxuICBleHBvcnRGaWxlID0gd2luZG93LlVSTC5jcmVhdGVPYmplY3RVUkwoZGF0YSk7XHJcbiAgcmV0dXJuIGV4cG9ydEZpbGU7XHJcbn1cclxuXHJcbi8qIEdldCBhbGwgY29uZmlndXJhdGlvbnMgZnJvbSB0aGUgc3RvcmFnZSBhbmQgb3V0cHV0IGEganNvbiBmaWxlICovXHJcbmZ1bmN0aW9uIGV4cG9ydENvbmZpZygpIHtcclxuICBicm93c2VyLnN0b3JhZ2UubG9jYWwuZ2V0KG51bGwpLnRoZW4oKHJlc3VsdHMpID0+IHtcclxuICAgIGxldCBzZXR0aW5nc1VybHMgPSBPYmplY3Qua2V5cyhyZXN1bHRzKSxcclxuICAgICAgICBjb25maWd1cmF0aW9ucyA9IFtdO1xyXG5cclxuICAgIGlmIChzZXR0aW5nc1VybHMubGVuZ3RoID4gMCkge1xyXG4gICAgICBmb3IgKGxldCBzZXR0aW5nVXJsIG9mIHNldHRpbmdzVXJscykge1xyXG4gICAgICAgIGNvbmZpZ3VyYXRpb25zLnB1c2goe1xyXG4gICAgICAgICAgXCJ1cmxcIiA6IHNldHRpbmdVcmwsXHJcbiAgICAgICAgICBcImNvbG9yXCIgOiByZXN1bHRzW3NldHRpbmdVcmxdWzBdLFxyXG4gICAgICAgICAgXCJsYWJlbFwiIDogcmVzdWx0c1tzZXR0aW5nVXJsXVsxXSxcclxuICAgICAgICAgIFwicG9zaXRpb25cIiA6IHJlc3VsdHNbc2V0dGluZ1VybF1bMl1cclxuICAgICAgICB9KTtcclxuICAgICAgfVxyXG5cclxuICAgICAgbGV0IGNvbmZpZ3VyYXRpb25zX2pzb24gPSBKU09OLnN0cmluZ2lmeShjb25maWd1cmF0aW9ucyk7XHJcbiAgICAgIGxldCBsaW5rID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYScpO1xyXG4gICAgICBsaW5rLnNldEF0dHJpYnV0ZSgnZG93bmxvYWQnLCAnY29uZmlndXJhdGlvbnMuanNvbicpO1xyXG4gICAgICBsaW5rLmhyZWYgPSBtYWtlSnNvbkV4cG9ydEZpbGUoY29uZmlndXJhdGlvbnNfanNvbik7XHJcbiAgICAgIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQobGluayk7XHJcblxyXG4gICAgICAvLyB3YWl0IGZvciB0aGUgbGluayB0byBiZSBhZGRlZCB0byB0aGUgZG9jdW1lbnRcclxuICAgICAgd2luZG93LnJlcXVlc3RBbmltYXRpb25GcmFtZShmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgbGV0IGV2ZW50ID0gbmV3IE1vdXNlRXZlbnQoJ2NsaWNrJyk7XHJcbiAgICAgICAgbGluay5kaXNwYXRjaEV2ZW50KGV2ZW50KTtcclxuICAgICAgICBkb2N1bWVudC5ib2R5LnJlbW92ZUNoaWxkKGxpbmspO1xyXG4gICAgICB9KTtcclxuICAgIH1cclxuICB9LCBvbkVycm9yKTtcclxufVxyXG5cclxuLyogUmVhZCBpbXBvcnQgZmlsZSBhbmQgbG9hZCBhbGwgc2V0dGluZ3MgaW50byB0aGUgc3RvYWdlICovXHJcbmZ1bmN0aW9uIGltcG9ydENvbmZpZygpIHtcclxuICBsZXQgaW1wb3J0RmlsZUlucHV0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJpbXBvcnRGaWxlXCIpLFxyXG4gICAgICBpbXBvcnRGaWxlID0gaW1wb3J0RmlsZUlucHV0LmZpbGVzWzBdO1xyXG4gIGNvbnN0IHJlYWRlciA9IG5ldyBGaWxlUmVhZGVyKCk7XHJcblxyXG4gIC8vIFRoaXMgZXZlbnQgbGlzdGVuZXIgd2lsbCBoYXBwZW4gd2hlbiB0aGUgcmVhZGVyIGhhcyByZWFkIHRoZSBmaWxlXHJcbiAgcmVhZGVyLmFkZEV2ZW50TGlzdGVuZXIoJ2xvYWQnLCBmdW5jdGlvbigpIHtcclxuICAgIGxldCBpbXBvcnRfY29uZmlnX29iaiA9IEpTT04ucGFyc2UocmVhZGVyLnJlc3VsdCk7IC8vIFBhcnNlIHRoZSByZXN1bHQgaW50byBhbiBvYmplY3RcclxuXHJcbiAgICBpZiAoaW1wb3J0X2NvbmZpZ19vYmoubGVuZ3RoID4gMCkge1xyXG4gICAgICBpbXBvcnRfY29uZmlnX29iai5mb3JFYWNoKGZ1bmN0aW9uKGFycmF5SXRlbSkge1xyXG4gICAgICAgIHNhdmVTZXR0aW5ncyhhcnJheUl0ZW0udXJsLCBhcnJheUl0ZW0uY29sb3IsIGFycmF5SXRlbS5sYWJlbCwgYXJyYXlJdGVtLnBvc2l0aW9uLCB0cnVlKVxyXG4gICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICBpbXBvcnRGaWxlSW5wdXQudmFsdWUgPSBcIlwiO1xyXG4gIH0pO1xyXG5cclxuICByZWFkZXIucmVhZEFzVGV4dChpbXBvcnRGaWxlKTsgLy8gUmVhZCB0aGUgdXBsb2FkZWQgZmlsZVxyXG59XHJcblxyXG4kKGRvY3VtZW50KS5yZWFkeSgoKSA9PiB7XHJcbiAgLyogRGlzcGxheSBwcmV2aW91c2x5IHNhdmVkIG1hcmtlcnMgb24gc3RhcnR1cCAqL1xyXG4gIGluaXRpYWxpemUoKTtcclxuXHJcbiAgJCgnLnNhdmUnKS5jbGljaygoKSA9PiB7XHJcbiAgICBzYXZlU2V0dGluZ3MoKTtcclxuICB9KTtcclxuXHJcbiAgJCgnLmNsZWFyJykuY2xpY2soKCkgPT4ge1xyXG4gICAgY2xlYXJBbGwoKTtcclxuICB9KTtcclxuXHJcbiAgJCgnLmltcG9ydC1leHBvcnQnKS5jbGljaygoKSA9PiB7XHJcbiAgICAkKCcuZXhwb3J0LWltcG9ydC1jb250YWluZXInKS50b2dnbGUoKTtcclxuICB9KTtcclxuXHJcbiAgJCgnLmV4cG9ydCcpLmNsaWNrKCgpID0+IHtcclxuICAgIGV4cG9ydENvbmZpZygpO1xyXG4gIH0pO1xyXG5cclxuICAkKCcuaW1wb3J0JykuY2xpY2soKCkgPT4ge1xyXG4gICAgaW1wb3J0Q29uZmlnKCk7XHJcbiAgfSk7XHJcblxyXG4gICQoZG9jdW1lbnQpLmtleWRvd24oZnVuY3Rpb24oZXZlbnQpIHtcclxuICAgIC8vIEVudGVyXHJcbiAgICBpZiAoZXZlbnQua2V5ID09PSAnRW50ZXInIHx8IGV2ZW50LmtleSA9PT0gJ051bXBhZEVudGVyJykge1xyXG4gICAgICBzYXZlU2V0dGluZ3MoKTtcclxuICAgIH1cclxuXHJcbiAgICAvLyBFc2NhcGVcclxuICAgIGlmIChldmVudC5rZXkgPT09ICdFc2NhcGUnKSB7XHJcbiAgICAgIHdpbmRvdy5jbG9zZSgpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICB9XHJcbiAgfSk7XHJcblxyXG4gIHBpY2tyID0gUGlja3IuY3JlYXRlKHtcclxuICAgIGVsOiAnLmNvbG9yLXBpY2tlcicsXHJcbiAgICB0aGVtZTogJ25hbm8nLFxyXG4gICAgdXNlQXNCdXR0b246IGZhbHNlLFxyXG4gICAgc3dhdGNoZXM6IFtcclxuICAgICAgJ3JnYmEoMjQ0LCA2NywgIDU0LCAxKScsXHJcbiAgICAgICdyZ2JhKDIzMywgMzAsICA5OSwgMSknLFxyXG4gICAgICAncmdiYSgxNTYsIDM5LCAxNzYsIDEpJyxcclxuICAgICAgJ3JnYmEoMTAzLCA1OCwgMTgzLCAxKScsXHJcbiAgICAgICdyZ2JhKDYzLCAgODEsIDE4MSwgMSknLFxyXG4gICAgICAncmdiYSgzMywgMTUwLCAyNDMsIDEpJyxcclxuICAgICAgJ3JnYmEoMywgIDE2OSwgMjQ0LCAxKSdcclxuICAgIF0sXHJcbiAgICBjb21wb25lbnRzOiB7XHJcbiAgICAgIHByZXZpZXc6IHRydWUsXHJcbiAgICAgIG9wYWNpdHk6IGZhbHNlLFxyXG4gICAgICBodWU6IHRydWUsXHJcbiAgICAgIGludGVyYWN0aW9uOiB7XHJcbiAgICAgICAgaGV4OiBmYWxzZSxcclxuICAgICAgICByZ2JhOiBmYWxzZSxcclxuICAgICAgICBoc2xhOiBmYWxzZSxcclxuICAgICAgICBoc3ZhOiBmYWxzZSxcclxuICAgICAgICBjbXlrOiBmYWxzZSxcclxuICAgICAgICBpbnB1dDogdHJ1ZSxcclxuICAgICAgICBjbGVhcjogZmFsc2UsXHJcbiAgICAgICAgc2F2ZTogdHJ1ZVxyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgfSk7XHJcblxyXG4gIHBpY2tyLm9uKCdzYXZlJywgKGNvbG9yLCBpbnN0YW5jZSkgPT4ge1xyXG4gICAgLy8kKCcuc2V0dGluZ3MtaW5wdXQgI2NvbG9yJykudmFsKGNvbG9yLnRvSEVYQSgpLnRvU3RyaW5nKDApKTtcclxuICAgIGluc3RhbmNlLmhpZGUoKTtcclxuICB9KTtcclxufSk7XHJcbiJdfQ==
