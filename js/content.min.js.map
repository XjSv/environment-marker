{"version":3,"file":"content.min.js","names":["insertRibbon","color","url","label","fontSize","position","size","fontData","enableFaviconMarker","removeExistingRibbon","removeExistingStylesheets","changeFavicon","textColor","ribbonWrapper","document","createElement","ribbon","ribbonText","getContrastYIQ","undefined","className","textContent","appendChild","fontTmp","split","fontLocation","font","variant","weight","parseInt","italic","test","setAttribute","googleFontStylesheet","href","type","rel","head","style","innerHTML","body","hexColor","replace","substr","existingRibbons","querySelectorAll","remove","existingStylesheet","stylesheet","bgColor","txtColor","Favico","animation","badge","chrome","runtime","onMessage","addListener","message","sender","sendResponse","command"],"sources":["content.js"],"sourcesContent":["/**\r\n * Given a URL, background color create a ribbon and add it to the page.\r\n */\r\nfunction insertRibbon(color, url, label, fontSize, position, size, fontData, enableFaviconMarker) {\r\n  removeExistingRibbon();\r\n  removeExistingStylesheets();\r\n\r\n  if (enableFaviconMarker) {\r\n    // Set the a badge/bullet to the websites favicon.\r\n    changeFavicon(color, textColor);\r\n  }\r\n\r\n  let ribbonWrapper = document.createElement('div'),\r\n      ribbon = document.createElement('div'),\r\n      ribbonText = document.createElement('div'),\r\n      textColor = getContrastYIQ(color);\r\n\r\n  // For backwards compatibility for users that already have ribbons configured.\r\n  // @TODO: Remove sometime in the future\r\n  if (fontSize === undefined) {\r\n    fontSize = '14';\r\n  }\r\n\r\n  // For backwards compatibility for users that already have ribbons configured.\r\n  // @TODO: Remove sometime in the future\r\n  if (size === undefined) {\r\n    size = 'normal';\r\n  }\r\n\r\n  ribbonWrapper.className = 'em-ribbon-wrapper em-' + position + '-wrapper em-' + size + '-ribbon-wrapper';\r\n  ribbon.className = 'em-ribbon em-' + size + '-ribbon em-' + position + '-ribbon';\r\n  ribbonText.className = 'em-ribbon-label';\r\n  ribbonText.textContent = label;\r\n  ribbon.appendChild(ribbonText);\r\n  ribbonWrapper.appendChild(ribbon);\r\n\r\n  if (fontData) {\r\n    let fontTmp = fontData.split(':'),\r\n        fontLocation = fontTmp[0],\r\n        font = fontTmp[1],\r\n        variant = fontTmp[2] || '400',\r\n        weight = parseInt(variant,10),\r\n        italic = /i$/.test(variant);\r\n\r\n    ribbon.setAttribute('style',\r\n        \"background-color: \" + color +\r\n        \"; color: \" + textColor +\r\n        \"; font-size: \" + fontSize +\r\n        \"px; font-family: '\" + font +\r\n        \"'; font-weight: \" + weight +\r\n        \"; font-style: \" + (italic ? 'italic' : 'normal') + \";\");\r\n\r\n    if (fontLocation === 'google') {\r\n      let googleFontStylesheet = document.createElement('link');\r\n          googleFontStylesheet.href = 'https://fonts.googleapis.com/css?family=' + font + ':' + variant + '&display=swap';\r\n          googleFontStylesheet.type = 'text/css';\r\n          googleFontStylesheet.rel = 'stylesheet';\r\n          googleFontStylesheet.className = 'em-google-stylesheet';\r\n\r\n      document.head.appendChild(googleFontStylesheet);\r\n    } else {\r\n      let style = document.createElement('style');\r\n      style.innerHTML = \"@font-face { font-family:'\" + font + \"'; src:local('\" + font + \"'), url('/libraries/fontpicker/fonts/\" + font + \".woff') format('woff'); }\";\r\n      document.head.appendChild(style);\r\n    }\r\n  } else {\r\n    ribbon.setAttribute('style', \"background-color: \" + color + \"; color: \" + textColor + \"; font-size: \" + fontSize + \"px;\");\r\n  }\r\n  document.body.appendChild(ribbonWrapper);\r\n}\r\n\r\nfunction getContrastYIQ(hexColor) {\r\n  hexColor = hexColor.replace('#', '');\r\n  let r = parseInt(hexColor.substr(0, 2), 16),\r\n      g = parseInt(hexColor.substr(2, 2), 16),\r\n      b = parseInt(hexColor.substr(4, 2), 16),\r\n      yiq = ((r * 299) + (g * 587) + (b * 114)) / 1000;\r\n\r\n  return (yiq >= 128) ? 'black' : 'white';\r\n}\r\n\r\n/**\r\n * Remove any existing ribbons from the page.\r\n */\r\nfunction removeExistingRibbon() {\r\n  let existingRibbons = document.querySelectorAll('.em-ribbon-wrapper');\r\n  for (let ribbon of existingRibbons) {\r\n    ribbon.remove();\r\n  }\r\n}\r\n\r\n/**\r\n * Remove any stylesheets that have been previously injected from the page.\r\n */\r\nfunction removeExistingStylesheets() {\r\n  let existingStylesheet = document.querySelectorAll('.em-google-stylesheet');\r\n  for (let stylesheet of existingStylesheet) {\r\n    stylesheet.remove();\r\n  }\r\n}\r\n\r\n/**\r\n * Remove any stylesheets that have been previously injected from the page.\r\n */\r\n  function changeFavicon(bgColor, txtColor) {\r\n  let badge = 1;\r\n  let favicon = new Favico({\r\n      bgColor : bgColor,\r\n      textColor: bgColor,\r\n      type: 'circle',\r\n      position: 'down',\r\n      animation : 'popFade',\r\n    });\r\n\r\n  favicon.badge(badge); // Intial value\r\n}\r\n\r\n/**\r\n * Listen for messages from the background script.\r\n * Call \"insertRibbon()\" or \"removeExistingRibbon()\".\r\n*/\r\nchrome.runtime.onMessage.addListener( (message, sender, sendResponse) => {\r\n  if (message.command === 'addRibbon') {\r\n    insertRibbon(message.color, message.url, message.label, message.fontSize, message.position, message.size, message.font, message.enableFaviconMarker);\r\n  } else if (message.command === 'reset') {\r\n    removeExistingRibbon();\r\n    removeExistingStylesheets();\r\n  }\r\n\r\n  sendResponse('done');\r\n  //return Promise.resolve('done');\r\n});"],"mappings":"AAGA,SAASA,aAAaC,EAAOC,EAAKC,EAAOC,EAAUC,EAAUC,EAAMC,EAAUC,GAC3EC,uBACAC,4BAEIF,GAEFG,cAAcV,EAAOW,GAGvB,IAAIC,EAAgBC,SAASC,cAAc,OACvCC,EAASF,SAASC,cAAc,OAChCE,EAAaH,SAASC,cAAc,OACpCH,EAAYM,eAAejB,GAqB/B,QAjBiBkB,IAAbf,IACFA,EAAW,WAKAe,IAATb,IACFA,EAAO,UAGTO,EAAcO,UAAY,wBAA0Bf,EAAW,eAAiBC,EAAO,kBACvFU,EAAOI,UAAY,gBAAkBd,EAAO,cAAgBD,EAAW,UACvEY,EAAWG,UAAY,kBACvBH,EAAWI,YAAclB,EACzBa,EAAOM,YAAYL,GACnBJ,EAAcS,YAAYN,GAEtBT,EAAU,CACZ,IAAIgB,EAAUhB,EAASiB,MAAM,KACzBC,EAAeF,EAAQ,GACvBG,EAAOH,EAAQ,GACfI,EAAUJ,EAAQ,IAAM,MACxBK,EAASC,SAASF,EAAQ,IAC1BG,EAAS,KAAKC,KAAKJ,GAUvB,GARAX,EAAOgB,aAAa,QAChB,qBAAuB/B,EACvB,YAAcW,EACd,gBAAkBR,EAClB,qBAAuBsB,EACvB,mBAAqBE,EACrB,kBAAoBE,EAAS,SAAW,UAAY,KAEnC,WAAjBL,EAA2B,CAC7B,IAAIQ,EAAuBnB,SAASC,cAAc,QAC9CkB,EAAqBC,KAAO,2CAA6CR,EAAO,IAAMC,EAAU,gBAChGM,EAAqBE,KAAO,WAC5BF,EAAqBG,IAAM,aAC3BH,EAAqBb,UAAY,uBAErCN,SAASuB,KAAKf,YAAYW,EAC5B,KAAO,CACL,IAAIK,EAAQxB,SAASC,cAAc,SACnCuB,EAAMC,UAAY,6BAA+Bb,EAAO,iBAAmBA,EAAO,wCAA0CA,EAAO,4BACnIZ,SAASuB,KAAKf,YAAYgB,EAC5B,CACF,MACEtB,EAAOgB,aAAa,QAAS,qBAAuB/B,EAAQ,YAAcW,EAAY,gBAAkBR,EAAW,OAErHU,SAAS0B,KAAKlB,YAAYT,EAC5B,CAEA,SAASK,eAAeuB,GAOtB,OANAA,EAAWA,EAASC,QAAQ,IAAK,KAIjB,IAHRb,SAASY,EAASE,OAAO,EAAG,GAAI,IAGZ,IAFpBd,SAASY,EAASE,OAAO,EAAG,GAAI,IAEA,IADhCd,SAASY,EAASE,OAAO,EAAG,GAAI,KACQ,KAEjC,IAAO,QAAU,OAClC,CAKA,SAASlC,uBACP,IAAImC,EAAkB9B,SAAS+B,iBAAiB,sBAChD,IAAK,IAAI7B,KAAU4B,EACjB5B,EAAO8B,QAEX,CAKA,SAASpC,4BACP,IAAIqC,EAAqBjC,SAAS+B,iBAAiB,yBACnD,IAAK,IAAIG,KAAcD,EACrBC,EAAWF,QAEf,CAKE,SAASnC,cAAcsC,EAASC,GAElB,IAAIC,OAAO,CACrBF,QAAUA,EACVrC,UAAWqC,EACXd,KAAM,SACN9B,SAAU,OACV+C,UAAY,YAGRC,MATI,EAUd,CAMAC,OAAOC,QAAQC,UAAUC,aAAa,CAACC,EAASC,EAAQC,KAC9B,cAApBF,EAAQG,QACV7D,aAAa0D,EAAQzD,MAAOyD,EAAQxD,IAAKwD,EAAQvD,MAAOuD,EAAQtD,SAAUsD,EAAQrD,SAAUqD,EAAQpD,KAAMoD,EAAQhC,KAAMgC,EAAQlD,qBACnG,UAApBkD,EAAQG,UACjBpD,uBACAC,6BAGFkD,EAAa,OAAO"}