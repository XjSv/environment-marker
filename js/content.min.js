function insertRibbon(e,t,o,n,i,r,l,s){removeExistingRibbon(),removeExistingStylesheets(),s&&changeFavicon(e,b);let a=document.createElement("div"),c=document.createElement("div"),m=document.createElement("div"),b=getContrastYIQ(e);if(void 0===n&&(n="14"),void 0===r&&(r="normal"),a.className="em-ribbon-wrapper em-"+i+"-wrapper em-"+r+"-ribbon-wrapper",c.className="em-ribbon em-"+r+"-ribbon em-"+i+"-ribbon",m.className="em-ribbon-label",m.textContent=o,c.appendChild(m),a.appendChild(c),l){let t=l.split(":"),o=t[0],i=t[1],r=t[2]||"400",s=parseInt(r,10),a=/i$/.test(r);if(c.setAttribute("style","background-color: "+e+"; color: "+b+"; font-size: "+n+"px; font-family: '"+i+"'; font-weight: "+s+"; font-style: "+(a?"italic":"normal")+";"),"google"===o){let e=document.createElement("link");e.href="https://fonts.googleapis.com/css?family="+i+":"+r+"&display=swap",e.type="text/css",e.rel="stylesheet",e.className="em-google-stylesheet",document.head.appendChild(e)}else{let e=document.createElement("style");e.innerHTML="@font-face { font-family:'"+i+"'; src:local('"+i+"'), url('/libraries/fontpicker/fonts/"+i+".woff') format('woff'); }",document.head.appendChild(e)}}else c.setAttribute("style","background-color: "+e+"; color: "+b+"; font-size: "+n+"px;");document.body.appendChild(a)}function getContrastYIQ(e){return e=e.replace("#",""),(299*parseInt(e.substr(0,2),16)+587*parseInt(e.substr(2,2),16)+114*parseInt(e.substr(4,2),16))/1e3>=128?"black":"white"}function removeExistingRibbon(){let e=document.querySelectorAll(".em-ribbon-wrapper");for(let t of e)t.remove()}function removeExistingStylesheets(){let e=document.querySelectorAll(".em-google-stylesheet");for(let t of e)t.remove()}function changeFavicon(e,t){new Favico({bgColor:e,textColor:e,type:"circle",position:"down",animation:"popFade"}).badge(1)}chrome.runtime.onMessage.addListener(((e,t,o)=>{"addRibbon"===e.command?insertRibbon(e.color,e.url,e.label,e.fontSize,e.position,e.size,e.font,e.enableFaviconMarker):"reset"===e.command&&(removeExistingRibbon(),removeExistingStylesheets()),o("done")}));