const TAB_COUNT_COLOR_LIMIT=10,TAB_COUNT_COLOR_LOW="#28a745",TAB_COUNT_COLOR_HIGH="#dc3545",markersKey="__em-markers__";function onError(e){console.log(e)}function updateCount(e,r){browser.tabs.query({}).then(t=>{let o=t.length;r&&e&&t.map(e=>e.id).includes(e)&&o--,browser.browserAction.setBadgeText({text:o.toString()}),o>10?browser.browserAction.setBadgeBackgroundColor({color:"#dc3545"}):browser.browserAction.setBadgeBackgroundColor({color:"#28a745"})})}function updateContent(e){void 0!==e&&browser.tabs.get(e).then(r=>{""!==r.url&&browser.storage.local.get(markersKey).then(t=>{if(t[markersKey])for(let o of t[markersKey])-1!==r.url.indexOf(o.settingUrl)&&(browser.tabs.executeScript(e,{file:"/js/content.min.js"}).then(()=>{browser.tabs.sendMessage(e,{command:"addRibbon",url:o.settingUrl,color:o.settingColor,label:o.settingLabel,position:o.settingPosition,size:o.settingSize}).then(e=>{}).catch(onError)},onError),browser.tabs.insertCSS(e,{file:"/css/content.min.css"}).then(null,onError))},onError)},onError)}browser.tabs.onRemoved.addListener(e=>{updateCount(e,!0)}),browser.tabs.onCreated.addListener(e=>{updateCount(e,!1)}),browser.tabs.onUpdated.addListener(e=>{updateContent(e)}),updateCount(),updateContent();
//# sourceMappingURL=background.min.js.map
